# DICE/RDE システム操作支援ツール

---

**バージョン: v1.13.1（2025-08-22）**
---

## v1.13.1 変更点（要約）
- 安定版
---

## 実行方法
0. アプリを起動するとinput 及び output フォルダが自動生成されます。
1. 必要に応じて `input/` フォルダを作成し、以下のファイルを配置してください。
  - `login.txt`: 自動ログイン用の情報を記載
  - `list.txt`: 一括取得用のリストを記載
2. `arim_rde_tool.exe` をダブルクリックして実行します。
3. 出力は `output/` フォルダに保存されます。


このリポジトリは、DICE/RDEシステムの利用支援ツールのバイナリ配布専用です。
個人が便利のために作成したもので、自由にご利用いただけますが、**無保証**です。

---

# 主な機能（RDE補助ツール v1.13.1）

## データ取得・登録機能
- **書誌情報取得**
  - RDEから課題番号リストを基に書誌情報とサムネイル画像を自動取得
  - JSON形式でのデータ保存に対応

- **データ取得2（ファイル一括取得）**
  - データセットに紐づくファイルを一括でダウンロード
  - 画像、CSV、XLSXなど多形式対応

- **データセット新規開設**
  - サブグループ、課題番号、テンプレートを指定してデータセットを作成
  - 公開制限（エンバーゴ期間）設定に対応

- **データ登録**
  - 実験情報・試料情報・添付ファイルをまとめて登録
  - 実験ID・ファイルパスを自動生成

---

## サブグループ管理機能
- **サブグループ新規作成**
  - メンバー、権限（OWNER/ASSISTANT）を指定して作成
  - 複数グループを一括登録可能

- **サブグループ修正**
  - 既存グループの構成や権限を編集
  - グループ名や課題番号の変更も可能

---

## 出力・可視化機能
- **XLSX出力**
  - ユーザー、サブグループ、データセット一覧をまとめてExcel出力
  - Excelフィルタ機能に対応

- **リクエスト解析**
  - RDE APIリクエストを可視化
  - DevTools不要でAPIデバッグ可能

---

## AI連携機能（試験実装）
- **AIテスト機能**
  - OpenAI / Gemini / ローカルLLMに対応
  - 実験概要の自動要約
  - マテリアルインデックス（MI）の自動推定

---

## 補足
- 設定タブは v1.13.1 時点で未実装
- RDEアカウント情報だけで基本機能は利用可能
- API仕様変更時はバージョン更新が必要



## ダウンロード

最新版バイナリは以下より取得してください。  
https://github.com/MNagasako/misc-rde-tool-public/releases

---


## 使用方法

### 1. 初回起動時の警告について

Windowsのセキュリティ警告やアンチウイルスによりブロックされる場合があります。  
必要に応じて例外設定してください。

<img width="532" height="498" alt="2025-07-31_18h22_53" src="https://github.com/user-attachments/assets/5117baeb-973c-4a7d-aed6-8f2d58400f26" />
<img width="532" height="498" alt="2025-07-31_18h23_02" src="https://github.com/user-attachments/assets/56e2ecce-466c-420e-ba84-95fc0eceacb5" />


### 1. ログイン
<img width="1062" height="698" alt="2025-07-31_10h49_43" src="https://github.com/user-attachments/assets/c9e7f1c9-cb3f-4f39-9572-693378c33d40" />
RDEアカウントでログインしてください。自動ログインしたい場合は、`input/login.txt` ファイルの先頭に以下の内容を保存してください（DICEアカウントのみ対応）。

```txt
username(mail)
password
dice
```

---

### 2. データ取得（旧方式）
<img width="1062" height="772" alt="2025-07-31_10h55_14" src="https://github.com/user-attachments/assets/a51db1a7-1fce-469b-a912-7d213186b8c8" />
ARIM課題番号を入力し「実行」ボタンをクリックすると、該当課題のデータセットJSONや画像ファイルを取得できます。

- JSONファイルは匿名化版が生成されます。
- WEBVIEW経由のためダウンロードに時間がかかります。
- `input/login.txt` に複数課題番号を記載しておくと「一括実行」ボタンでまとめて処理できます。

```txt
JPMX12xxTUxxxx
JPMX12xxTUyyyy
JPMX12xxTUzzzz
```

---

### 3. 基本情報取得
<img width="1062" height="925" alt="2025-08-22_13h50_22" src="https://github.com/user-attachments/assets/bb481a4b-3585-409e-bad3-1941694ee20d" />


「**基本情報**」メニューから **「基本情報取得（ALL または 検索）」** および **「invoice_schema取得」** を実行します。

この機能は、RDEサーバー上のデータセットや関連情報を、ローカルアプリで検索・操作できるようにするため、**ログインユーザーの権限でアクセス可能な情報を一括取得する機能**です。これを済ませておかないと、一部機能が正しく動作しません。

---

#### 基本情報取得の種類

- **ALL**：ログインユーザーがアクセス可能な**すべてのデータセット**を取得します。
- **検索 + 検索窓が空欄**：ログインユーザーの名前でフィルタリングされたデータセットのみ取得します。
- **検索 + 検索窓にキーワード**：キーワードに一致するデータセットを取得します。

> データセット一覧ページの検索機能と同じ挙動です。

---

#### 実行時の注意点

- **初回は時間がかかります**。特に **ALL** は非常に時間がかかります。
- 2回目以降は、すでに取得済みの情報（ローカルファイル）の取得は**自動でスキップ**されます。
- 更新確認はファイルのタイムスタンプを基に行っています。
- 進行状況が不安な場合は、`output/rde/data/datasets` または `output/rde/data/dataEntry` の中身を確認してください。ファイルが増えていれば正常です。
- **強制的に再取得したい場合**は、対象のローカルファイルを削除した上で再実行してください。

> 初回実行時は、コーヒーでも飲みながらお待ちいただくのがおすすめです ☕️



#### データ取得2（新方式）
<img width="1062" height="528" alt="2025-07-31_11h54_40" src="https://github.com/user-attachments/assets/cb5fd9dc-d093-47a5-9bd0-df88b75d0764" />
1. 基本情報取得後、ドロップダウンリストにアクセス可能な課題（データセット）が表示されます。
2. 「選択データセットのファイルリスト取得」ボタンで、該当データセットの書誌情報JSONと全画像ファイル（構造化済み）を取得できます。
3. 書誌情報は匿名化版が生成されます。

---
#### サブグループ作成
<img width="1062" height="995" alt="2025-08-22_13h52_46" src="https://github.com/user-attachments/assets/6f4ecf71-22ab-4eea-87de-486e7f28934e" />

サブグループ作成は、データセットやメンバー管理を効率化するための重要な機能です。以下の手順で操作してください。

---

### サブグループ作成手順

1. **グループメンバーを選択**
   - メンバーごとに役割を選択します。
   - 選択肢：**管理者（OWNER）**、**代理管理者（ASSISTANT）**。

2. **グループ名・説明・課題番号を入力**
   - 「課題番号:課題名」形式で入力します。
   - 複数入力する場合は、**改行せずにカンマ区切り**で記載します。
   - 例：
     ```
     JPMXP1001:鉄鋼材料評価,JPMXP1002:セラミックス分析,JPMXP1003:複合材試験
     ```

3. **「サブグループ作成」ボタンをクリック**
   - 入力内容に基づいてサブグループが作成されます。

4. **作成後の更新**
   - 「基本情報」メニューから共通情報を再取得してください。
   - 新規サブグループをリストに反映するため必要です。

---

### 自動選択設定（オプション）

`input/rde-member.txt` にメールアドレスと権限を事前登録しておくと、自動で選択されます。

```txt
# mailaddress , role(1=OWNER,2=ASSISTANT),canCreateDatasets(1=True),canEditMembers(1=True),;
xxxxxxxxxx@tohoku.ac.jp,2,1,1;
yyyyyyyyyy@tohoku.ac.jp,2,1,1;
zzzzzzzzzz@tohoku.ac.jp,2,1,1;
wwwwwwwwww@tohoku.ac.jp,1,1,1;
```
> `#` で始まる行はコメントとして扱われます。

---

#### サブグループ修正

<img width="1062" height="273" alt="2025-08-22_13h55_08" src="https://github.com/user-attachments/assets/09d32cbd-5cd4-477b-ab24-a305ab8f02be" />

既存サブグループの情報を変更する場合は、以下の手順で操作します。

1. **「サブグループ」メニューで修正タブをクリック**
2. **対象サブグループを選択**
   - ドロップダウンリストから選択できます。
   - 補完検索にも対応しているため、キーワードで素早く絞り込み可能です。

<img width="1062" height="995" alt="2025-08-22_13h55_16" src="https://github.com/user-attachments/assets/de8bc822-4d5c-4eb1-9ee5-22cd01431ad9" />

3. **内容を修正し「サブグループ更新」ボタンをクリック**
   - メンバー、権限、課題番号、グループ名などを更新可能です。

> 修正後は「基本情報取得」を再実行し、最新情報を反映することを推奨します。

---

#### データセット開設
<img width="1062" height="528" alt="2025-07-31_10h51_01" src="https://github.com/user-attachments/assets/22f8d8f1-9f92-40e0-bab6-10e6cf0588cf" />
データセット開設時は以下の手順で操作します。

1. サブグループを選択（補完検索可）
2. 課題番号を選択
3. テンプレートを選択
4. データセット名・エンバーゴ終了日を入力
5. 広域シェア・匿名化の有無を選択
6. 「データセット開設実行」ボタンで作成
7. 作成後は「基本情報」メニューで共通情報を再取得（自動再取得されるようになりました）

---

#### データ登録
<img width="1062" height="791" alt="2025-07-31_10h54_30" src="https://github.com/user-attachments/assets/afc6fdc7-2342-4f31-a212-892261afd023" />
データ登録時は以下の手順で操作します。

1. データセットを選択（補完検索可）
2. データ名・説明・実験ID・参考URL・タグ・試料情報・固有情報を入力
3. データファイル（必須）・添付ファイル（任意）を選択
4. 「データ登録」ボタンで登録（同一データセットに連続登録可）

---

#### リクエスト解析（開発用）
- REST APIの解析用

#### 設定（未実装）

---

## 注意事項・免責
- 本リポジトリはバイナリ配布専用です。開発・ソース管理は別リポジトリで行っています。
- **本ツールは個人が便利のために作成したもので、無保証です。いかなる損害・不具合についても一切責任を負いません。**
- **再配布・転載は禁止します。必ずこのサイト（GitHub Releases）から最新版をダウンロードしてください。**
- ARIMデータ提供システムへの登録機能はありません（登録は手動でお願いします）。
- ご要望があれば対応するかもしれません。
- ご質問・不具合報告は開発用リポジトリのIssueをご利用ください。

---


---


- v1.12.6（2025-08-19）: ドキュメント・README最新版に更新（配布構成・実行方法・注意事項統一）
- v1.12.5（2025-08-18）: AI機能の包括的強化・レスポンス情報管理・CLI版AIテストツール追加
- v1.12.4（2025-08-17）: パス依存修正・バイナリ化対応強化
- v1.12.3: クリーンアップ・UI/UX改善・パフォーマンス最適化
- v1.12.2: 機能追加・リファクタリング
- v1.12.1: ドキュメント更新・細部修正
- v1.12.0: 内部更新のみ
- v1.11.1: 内部更新のみ
- v1.11.0: ドキュメント更新
- v1.9.11: 内部更新のみ
- v1.9.10: 内部更新のみ
- v1.9.9: 内部更新のみ
- v1.9.8: 内部更新のみ
- v1.9.7: 内部更新のみ
- v1.9.6: 内部更新のみ
- v1.9.5: 内部更新のみ
- v1.9.4: 内部更新のみ
- v1.9.3: uploadId重複バリデーションエラー対策、payload仕様・ドキュメント最新化
- v1.9.2b: summary.xlsx仕様統一、細部修正
- v1.7.2: サニタイズ処理統一・循環インポート修正

リリースページ: https://github.com/MNagasako/misc-rde-tool-public/releases

## ライセンス・問い合わせ
- ライセンス: 未定
- 制作: 東北大金研 長迫



## 関連ツール
- https://github.com/MNagasako/BJB-PathFlattener
