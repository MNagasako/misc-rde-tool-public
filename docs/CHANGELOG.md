# CHANGELOG

> ⚠️ **注意**: このファイルは公開配布版向けドキュメントです。完全な開発履歴は開発リポジトリ（`C:/vscode/rde`）の `src/config/common.py` 内の履歴コメントを参照してください。

---

## v2.1.10 (2025-11-28) - データセット編集機能改善

### 🔧 データセット編集

- **Completerフィルタ選択の完全対応**
  - フィルタ検索で絞り込んだデータセットを選択時、正しくフォームに読み込み
  - 2段階検索方式実装（テキスト完全一致 → IDベース検索）
  - `extract_dataset_id_from_text()` ユーティリティ関数追加

- **バッチ登録422エラー対応強化**
  - RDE必須ヘッダー（`Accept: application/vnd.api+json`）を追加
  - フォールバック時も同じヘッダーを送信
  - 詳細エラー情報（URL・ヘッダー・ボディ）をダイアログで表示

### 🧪 テスト強化

- **新規テスト追加**
  - `test_completer_id_extraction.py`（8テスト）- ID抽出ロジック検証
  - `test_dataset_edit_widget.py`（3テスト）- ウィジェット動作検証
  - 全テストスイート正常動作確認（ユニット15件・ウィジェット22件合格）

### 🐛 バグ修正

- Completer選択時のインデックス検索失敗を修正
- ウィジェットテストの互換性修正（`SupportedFileFormatEntry`対応）

---

## v2.1.9 (2025-11-28) - バージョン更新

### 📝 リビジョン管理

- バージョン番号を2.1.9に更新

---

## v2.1.8 (2025-11-22) - AI拡張機能大幅強化

### 🤖 AI関連新機能

- **ファイルテキスト自動抽出機能**
  - データセット内の複数ファイルから自動でテキスト抽出
  - 対応フォーマット: Excel（.xlsx, .xls）、CSV、JSON、テキストファイル等
  - プロンプトテンプレート内の `text_from_structured_files` プレースホルダーで利用可能

- **使用プロンプト表示ボタン**
  - AI処理実行後、実際に送信したプロンプト内容を確認・コピー可能
  - 文字数・行数の統計情報表示
  - デバッグ・検証用途に最適

- **ファイル抽出設定タブ（永続化対応）**
  - 対象ファイル種別（拡張子指定）
  - 除外ファイルパターン（正規表現対応）
  - 処理ファイル数上限（1～100件）
  - ファイルサイズ上限（1～100MB）
  - 出力文字数制限（100～50,000文字/ファイル）
  - Excel処理オプション（全シート処理/行数上限）
  - 設定の保存・読み込み・リセット機能

### 🔧 技術改善

- 依存ライブラリのセキュリティ更新
- openpyxl 警告抑制（Data Validation extension）
- 文字エンコーディング処理の堅牢化

### 📝 ドキュメント更新

- README.md: AI機能セクション拡充
- AI_FEATURE_GUIDE.md: 新機能説明追加

---

## v2.1.7 (2025-11-22) - テーマ切替最適化

### ⚡ パフォーマンス改善

- **テーマ切替最適化**
  - `refresh_theme()` で配色のみ更新
  - ファイルIO・API呼び出し・UI再構築を完全に回避
  - テーマ変更が即座に反映（処理時間大幅短縮）

- **グローバルスタイル統一**
  - QMenu, QToolTip, QHeaderView, QProgressBar スタイル統一
  - OS/アプリケーションテーマ不一致への対応強化
  - パレット強制適用による一貫性確保

### 🔍 品質保証

- テーマウィジェット監査完了
- テーマ適用検証スクリプト実装
- 全テーマパターンの動作確認完了

---

## v2.1.6 (2025-11-17) - プロキシ・SSL改善完了

### 🔒 セッション・SSL管理強化

- **セッション管理の再構築**
  - `create_new_session()` メソッド追加（グローバルセッションから独立可能）
  - truststore 完全対応（全セッション作成時に Windows 証明書ストア自動適用）
  - MANUAL/HTTP モード統一処理実装

- **SSL/CA証明書診断機能**
  - システムプロキシ自動検出
  - SSL証明書チェーン検証
  - カスタムCA証明書対応テスト
  - MitM環境対応（--allow-mitm / --no-mitm フラグ）

### 🔧 診断ツール体系構築

6種類の統合診断スクリプトを提供：

1. **基本プロキシ診断** (`test_basic_proxy.py`)
2. **システムプロキシ検出** (`test_system_proxy_detection.py`)
3. **SSL/CA証明書診断** (`test_ssl_certificate.py`)
4. **設定保存・読み込みフロー** (`test_config_flow.py`)
5. **連続接続安定性** (`test_connection_stability.py`)
6. **統合診断ランナー** (`run_all_diagnostics.py`)

### 📚 ドキュメント化

- `docs/NETWORK_ACCESS_ARCHITECTURE.md` 完全改訂
  - SSL証明書セクション詳細化（優先順位の明確化）
  - 診断ツール使用ガイド新設
  - Fiddler統合ガイド追加
  - トラブルシューティングセクション充実

- `config/network.yaml` デフォルト設定改善
  - 初期モード設定を DIRECT に変更（プロキシエラー防止）
  - Fiddler 使用例明示

---

## v2.1.5 (2025-11-17) - プロジェクト構成整理

### 📁 コードベース整理

- **プロジェクト構成整理完了**
  - `tests/` フォルダへテストコード移動
  - `tools/` フォルダへユーティリティ類移動
  - リリースノートを `docs/archive/` へアーカイブ

- **PyQt5 残滓完全除去**
  - 全ソースコードから PyQt5 関連コード削除完了
  - PySide6 への完全移行確認

- **依存関係更新**
  - `requirements.txt` 最新化
  - 不要な依存関係削除
  - セキュリティアップデート適用

### 📚 ネットワークアーキテクチャドキュメント化

- `docs/NETWORK_ACCESS_ARCHITECTURE.md` 作成
  - REQUESTS ベースアクセス詳細説明
  - WEBVIEW ベースアクセス詳細説明
  - プロキシ・SSL 設定完全マッピング
  - 依存関係・ファイル構成可視化
  - トラブルシューティングガイド

### 🔧 セッション管理フロー

- `net.session_manager`: グローバルセッション管理
- `net.http_helpers`: HTTP リクエストラッパー
- 使用箇所の完全マッピング・ドキュメント化

---

## v2.1.4 (2025-11-13) - バージョン管理統一・品質改善

### 📋 バージョン管理統一

- VERSION.txt・README.md・CHANGELOG.md 全体で表記統一
- 各ドキュメント・ファイルのバージョン表記一貫化
- RELEASE_NOTES_v2.1.4.md 追加

### 🛠 品質改善継続

- **ログ統一化完了**
  - `print()` から `logger` への統一化完了
  - 全ファイル対応・ログレベル統一管理
  - DEBUG/INFO/WARNING/ERROR の明確なレベル分け

- **既存機能の安定性向上**
  - truststore 統合 SSL 検証
  - API ログ機能・Daily rotation 対応
  - プロキシ再起動プロンプト実装

### 📝 ドキュメント更新

- README.md バージョン表記更新
- CHANGELOG.md 更新

---

## v2.1.4 (2025-11-08) - PyQt5→PySide6完全移行

> **破壊的変更**: このアップデートで PySide6 への完全移行が完了しました。

### 🎉 メジャーアップデート

- **フレームワーク刷新**: PyQt5 → PySide6 完全移行
- **ライセンス方針変更**: LGPLv3 へ統一
- **配布戦略変更**: ソースコード非公開化方針へ移行
- **UI 改善**: PySide6 による UI 品質向上

### 🔧 技術改善

- WebView 動作改善（blob:URL 対応）
- JavaScript 連携改善
- UI レンダリング最適化
- ハイDPI ディスプレイ対応強化

### 📝 ライセンス・配布

- LGPLv3 ライセンス採用
- GitHub Releases での配布体制構築
- バイナリ配布版メインへシフト

---

## 前のバージョン

> 詳細な開発履歴は、開発リポジトリ内の以下を参照してください：
> - `src/config/common.py`: 詳細なバージョン履歴コメント（v2.0.0 以降）
> - `docs/archive/`: 過去のリリースノート
> - README.md: 主要な機能・変更点まとめ

---

## 今後の予定

- **対応予定機能**
  - データカタログの作成・編集
  - 送り状編集機能
  - 添付ファイル削除機能
  - CSVによるグループメンバー一括置換
  - 関連試料設定機能

- **継続的改善**
  - パフォーマンス最適化
  - UI/UX さらなる向上
  - エラーハンドリング強化
  - ドキュメント拡充

### 🎉 新機�E
- truststore統合によるSSL検証強化！Eindows証明書ストア対応！E
- APIアクセスログ機�E実裁E��Eaily rotation・自動クリーンアチE�E�E�E
- プロキシ設定変更時�E自動�E起動�Eロンプト実裁E
- SSL/プロキシ/処琁E��間�E匁E��皁E��グ記録

### 🛠 改喁E�E変更
- 旧機�E�E�E2.1.4以前）�E安定性維持�E堁E��性向丁E
- ト�Eクン管琁E��スチE���E�EokenManager�E��EDICEログイン調査チE�Eルの継承

### 📝 ドキュメント更新
- README.md機�E説明更新
- VERSION.txt更新
- RELEASE_NOTES_v2.1.4.md追加

---
## v2.1.4 (2025-11-10) - ト�Eクン管琁E��スチE��・DICEログイン調査チE�Eル追加

### 🎉 新機�E
- **ト�Eクン管琁E��スチE���E�EokenManager�E�実裁E*
  - OAuth2 RefreshToken対忁E
  - 自動トークンリフレチE��ュ�E�ETimer 60秒間隔、E刁E��マ�Eジン�E�E
  - 手動リフレチE��ュAPI
  - JWT有効期限解析�E管琁E
  - マルチ�Eスト対応！EDE/Material API�E�E
- **ト�Eクン状態表示タブ追加**
  - 褁E��ホスト�Eト�Eクン一覧表示
  - 有効期限・残り時間表示
  - 手動リフレチE��ュボタン
  - 自動リフレチE��ュON/OFF刁E��
- **DICEログイン調査チE�Eル実裁E(v2.1.4)**
  - dice_login_flow_inspector.py�E�標準版・fragment mode�E�E
  - dice_login_flow_inspector_query_mode.py�E�クエリモード版�E�E
  - 自動ログイン機�E・ト�Eクン抽出・JWT解极E

---

## v2.1.4 (2025-11-07) - チE�Eタポ�Eタル統合機�E完�E実裁E

### 🎉 新機�E
- **チE�Eタポ�Eタル統合機�E完�E実裁E*
  - JSON書誌情報アチE�Eロード機�E�E�匿名化オプション・環墁E��認証管琁E��E
  - 画像ファイル一括アチE�Eロード機�E�E�重褁E��ェチE��・プログレス表示�E�E
  - チE�Eタポ�Eタル修正機�E�E��Eフィールドタイプ対応�EメタチE�Eタ動的取得�E2段階保存！E
  - スチE�Eタス管琁E���E�E��E閁E非�E開ワンクリチE��刁E��替え！E

### 🔧 改喁E�E変更
- **UI/UX改喁E*
  - チE��ォルト選択最適化（データセチE��検索をデフォルトに�E�E
  - フィルタ統合（庁E��シェア設定と関係メンバ�EフィルタめE行に統合！E
  - ボタン配置最適化（視認性向上！E
- **アーキチE��チャ改喁E*
  - 責務�E離�E�EI・コア・設定�EユーチE��リチE��の明確な刁E���E�E
  - モジュラー設計！Eore/ui/conf/utilチE��レクトリ構造�E�E
- **チE��チE��機�E強匁E*
  - 全APIレスポンスのHTMLファイル保孁E
  - 詳細ログ出力�EスタチE��トレース付きエラーログ

### 🐛 バグ修正
- フィールド名修正�E�実際のHTML構造に合わせた修正�E�E
- ラベル抽出改喁E��ラジオボタン・チェチE��ボックスのラベル抽出ロジチE��改喁E��E
- 初期表示修正�E�データセチE��検索モードがチE��ォルトで表示されるよぁE��修正�E�E

### 📝 ドキュメント更新
- README.md機�E説明更新
- VERSION.txt更新
- RELEASE_NOTES_v2.1.4.md追加

## v2.1.4 (2025-10-31) - ARIM報告書スクレイピング修正・AI拡張タブ検索補完機�E強匁E

### 🛠 主な変更点
- ARIM報告書のスクレイピング処琁E�E修正・安定化
- AI拡張タブ�E検索補完機�Eを強匁E
- チE�Eタ処琁E��ジチE��の改喁E
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-31) - QWidgetサイズエラー修正・AI Test 2ボタン安定化

### 🛠 主な変更点
- QWidgetサイズエラーの修正
- AI Test 2ボタンの安定化
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-31) - ライブラリ更新・安定性向丁E

### 🛠 主な変更点
- 依存ライブラリの更新・互換性の確俁E
- 軽微な修正・安定性向丁E
- ドキュメント�E整琁E�E更新

## v2.1.4 (2025-10-06) - 軽微な修正・安定性向丁E

### 🛠 主な変更点
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-06) - 軽微な修正・安定性向丁E

### 🛠 主な変更点
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-03) - チE�EタセチE��説明AIサジェスト機�E追加

### 🚀 主な変更点
- チE�EタセチE��説明欁E��AIサジェスト機�Eを追加し、説明文の自動生成�E補助が可能になりました、E

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E




## v2.1.4 (2025-09-30) - 軽微な修正・安定性向丁E

### 🔧 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-01) - 軽微な修正・安定性向丁E

### 🔧 軽微な修正・安定性向丁E

# v2.1.4 (2025-10-02) - 機�E追加・安定性向丁E

### 🚀 主な変更点
- 新機�E・改喁E��の記載（例：UI改喁E��バグ修正、パフォーマンス向上など�E�E

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E
# 変更履歴�E�EHANGELOG�E�E

## v2.1.4 (2025-09-22) - 軽微な修正・安定性向丁E

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E

## v2.1.4 (2025-09-21) - 一括登録・サブグループ編雁E�EAIチE��ト�E細かなバグ修正

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E

## v2.1.4 (2025-09-18) - ドキュメント整琁E�E安定性向丁E

### 📝 ドキュメント整琁E�E安定性向丁E
- README/CHANGELOGのバ�Eジョン履歴を整琁E
- 軽微な安定性向上�E細かな修正

## v2.1.4 (2025-09-17) - 安定性向上�Eドキュメント整琁E

### 🛠�E�E細かなバグ修正・最適匁E
- 冁E��処琁E�E安定性向上�E軽微な不�E合修正
- CHANGELOG/READMEのバ�Eジョン履歴整琁E

## v2.1.4 (2025-09-17) - 安定性向上�Eドキュメント整琁E

### 🛠�E�E細かなバグ修正・最適匁E
- 冁E��処琁E�E安定性向上�E軽微な不�E合修正
- CHANGELOG/READMEのバ�Eジョン履歴整琁E

## v2.1.4 (2025-09-16) - AI機�E拡張・UI改喁E

### 🤁EAI機�E拡張・UI改喁E
- AIプロバイダ・モチE��定義の拡允E��ローカルLLM対応強匁E
- AI設定ファイルの説明追加、AIプロンプトカスタマイズ手頁E�E訁E
- AI連携時�Eエラーハンドリング強化�Eタイムアウト設定追加
- READMEのAI設定�Eバイナリ化手頁E�E既知の不�E合を最新匁E

## v2.1.4 (2025-09-01) - 動的ユーザー管琁E���E実裁E�EAPI補完機�E統吁E

### �E 動的ユーザー管琁E���E実裁E
- **動的ユーザー管琁E��スチE��**
  - rde-member.txtを読み取り専用化、動皁E��加ユーザーはoutput/temp/dynamic_users.jsonに保孁E
  - セチE��ョン間永続化・動的追加ユーザーの再起動後保持・subGroup.jsonとの統合表示
  - 透過皁E��合�E既存�E作�E/編雁E��ブで自動的にAPI補完が動作�Eユーザー体験向丁E

- **API補完機�E統吁E*
  - subGroup.json冁E�E不完�EユーザーチE�Eタ�E�EDのみ�E�をNIMS User APIで詳細チE�Eタ自動補宁E
  - 認証惁E��ストア統合�EBearer token連携・WebView認証後�EAPI呼び出し�E安�Eな認証惁E��管琁E
  - フォールバック機�E・API呼び出し失敗時は既存データを保持・エラー耐性を確俁E

- **シスチE��強匁E*
  - チE�EタセチE��フィルタ強化�E3層キャチE��ュシスチE��・プログレス表示・ComboBox最適匁E
  - 匁E��皁E��スト環墁E�E独立したテストスクリプト群・統合テスト機�E・品質保証体制

## v2.1.4 (2025-09-01) - プロキシ設定重要修正・手動設定値保持問題解決

### 🔧 プロキシ設定重要修正
- **手動プロキシ設定問題解決**
  - 手動プロキシ設定が適用後に自動設定で上書きされる問題を解決
  - 設定適用ロジチE��の最適化�E不要な再読み込み処琁E��除
  - 手動設定値の確実な保持・状態表示の刁E��

- **ユーザビリチE��向丁E*
  - 設定適用時�EチE��チE��ログ追加・適用過程�E可視化
  - 設定確認機�E強化�EトラブルシューチE��ング支援
  - プロキシ設定信頼性向上�E手動・自動設定�E明確な刁E��

## v2.1.4 (2025-09-01) - プロキシ設定UI改喁E�E横並び表示対忁E

### 🎨 プロキシ設定UI改喁E
- **チェチE��ボックス横並び表示**
  - PAC自動設定�E企業CA設定�EチェチE��ボックス横並び表示対忁E
  - 設定画面レイアウト最適化�Eスクロールエリア高さ調整
  - 視認性向上�EユーザビリチE��改喁E

- **プロキシ設定フォーム改喁E*
  - カスタムCA Bundle入力欁E��加・SSL設定�E整琁E��吁E
  - 企業環墁E��応強化�EPAC�E��Eロキシ自動設定）サポ�EチE
  - レイアウト最適化�E惁E��寁E��向上�E操作性改喁E

## v2.1.4 (2025-08-31) - ワークスペ�Eス大規模整琁E��亁E�Eコード�Eース品質向丁E

### 🔄 ワークスペ�Eス大規模整琁E��亁E
- **アーキチE��チャ最適匁E*
  - 不要ファイル削除・コード�Eース品質向丁E
  - 重褁E��ード削除・依存関係整琁E�Eモジュール構造改喁E
  - 開発環墁E��定化・保守性向丁E

- **配币E��チE��ージ最適匁E*
  - PyInstaller配币E��チE��ージ最適化�Eビルド�Eロセス改喁E
  - ドキュメント体系強化�E設計書・仕様書・運用手頁E��の整備�E宁E
  - 継続的品質改喁E�E静的解析�EチE��トカバレチE��向上�ECI/CD基盤強匁E

## v2.1.4 (2025-08-24) - リファクタリング継続�Eフォーム機�E刁E��・保守性向丁E

### 🔄 アーキチE��チャ改喁E
- **責務�E離完亁E*
  - UIControllerForms刁E��によるフォーム機�E専門匁E
  - フォーム関連機�Eの独立クラス匁E
  - UI責務�E確化による保守性向丁E

- **コード�Eース整傁E*
  - 重褁E��ード削除616行！E5.4%削減）完亁E
  - 品質改喁E�EアーキチE��チャ強化継綁E
  - 刁E��されたクラス構造による開発・保守効玁E��

### 📋 ドキュメント更新
- **バ�Eジョン管琁E*
  - `VERSION.txt` v2.1.4更新・変更履歴追訁E
  - `README.md` 最新機�Eセクション・リリース履歴更新
  - 開発進捗反映・技術仕様書最新匁E

## v2.1.4 (2025-08-22) - 継続的メンチE��ンス・コード�Eース整傁E

### 🔄 継続的品質向丁E
- **コード�Eース整傁E*
  - 全ファイルのバ�Eジョン表記統一�E�E2.1.4�E�E
  - ドキュメント最新化�E技術仕様書整備継綁E
  - 開発ガイドライン・保守手頁E��続改喁E

- **安定性維持E*
  - 既存機�Eの堁E��性継続保証
  - バグ修正対応体制継続強匁E
  - チE��トカバレチE��品質水準維持E

## v2.1.4 (2025-08-21) - サブグループUI改喁E�Eパス管琁E��スチE��大幁E��匁E

### �E サブグループ機�EUI大幁E��喁E
- **課題�E力テキストエリア匁E*
  - 一行テキスト�EチE��ス ↁE褁E��行表示可能なチE��ストエリアに変更
  - 褁E��課題�E視認性・編雁E��大幁E��丁E
  - 適刁E��表示領域確保（高さ80px�E�E

- **リアルタイムバリチE�Eション機�E**
  - 改行チェチE���E�改行文字混入の即座検�E・警呁E
  - フォーマット検証�E�`課題番号:課題名`形式適合性リアルタイム確誁E
  - 空欁E��証�E�課題番号・課題名空欁E���E
  - ビジュアルフィードバチE���E�色付きボ�Eダー・メチE��ージによる即座状態確誁E

### 🏗�E�EシスチE��基盤大幁E��匁E
- **パス管琁E��スチE��再設訁E*
  - ワーキングチE��レクトリ依存性完�E解涁E
  - プロジェクト構造自動検証・ルート特宁E
  - 匁E��皁E��ストスイート整備：パス解決・バリチE�Eション・バイナリ環墁E��スチE

## v2.1.4 (2025-08-19) - チE�EタセチE��登録・開設UIバグ修正

### 🐛 バグ修正
- **チE�EタセチE��関連UI修正**
  - PyQt5 import scope error解決
  - チE�EタセチE��登録・開設機�Eの安定性向丁E
  - UI表示エラーの修正

## v2.1.4 (2025-08-18) - AI機�Eレスポンス惁E��表示強化�E統合テストツール追加

### 🤁EAI機�E改喁E
- **レスポンス惁E��表示強匁E*
  - ト�Eクン使用量�E処琁E��間�E詳細表示
  - パフォーマンス惁E��の可視化改喁E
  - ユーザビリチE��向丁E

- **統合テストツール追加**
  - AI性能チE��ト�Eベンチ�EークチE�Eル実裁E
  - 褁E��プロバイダー対応テスト環墁E
  - 結果刁E��・可視化機�E

---

## 主な機�E

### チE�Eタ取得�E登録機�E
- **書誌情報取征E*�E�課題番号リストからRDEの書誌情報とサムネイル画像を自動取征E
- **チE�Eタ取征E�E�ファイル一括取得！E*�E�データセチE��に紐づくファイルを一括ダウンローチE
- **チE�EタセチE��新規開設**�E�サブグループや課題番号を指定してチE�EタセチE��を作�E
- **チE�Eタ登録**�E�実験情報・試料情報・添付ファイルを登録

### サブグループ管琁E���E
- **サブグループ新規作�E**�E�メンバ�Eと権限を持E��した一括登録
- **サブグループ修正**�E�既存グループ�E構�E・課題番号・権限変更

### AI活用機�E
- **実験手法生戁E*�E�OpenAI/Gemini/ローカルLLMによる研究支援
- **品質評価**�E�データ品質の自動評価とアドバイス
- **チE�EタセチE��説明文生�E**�E�研究冁E��に基づく説明文自動生戁E

### ユーチE��リチE��機�E
- **設定ファイル管琁E*�E�JSON/Excel形式での設定保存�E読込
- **エラーハンドリング**�E�詳細なログ出力とエラー回復機�E
- **セキュリチE��**�E�DICE認証・セチE��ョン管琁E
