# CHANGELOG

> ⚠️ **注意**: このファイルは公開配布版向けドキュメントです。完全な開発履歴は開発リポジトリ（`C:/vscode/rde`）の `src/config/common.py` 内の履歴コメントを参照してください。


## v2.4.4 (2026-01-04) - メール通知タブ: 自動通知の送信対象にリストフィルタ適用 + 基準日時モード + テンプレ運用改善

### ✉️ メール通知タブ（運用改善）

- 対象通知リストのフィルタ（エラーコード/設備ID/管理者名/管理者メール）を、自動通知の送信対象にも適用（表示されていないものは送信しない）。
- 「通知対象抽出」で、抽出前に最新情報を取得するか選択できるオプションを追加（自動通知と同等の挙動）。
- 基準日時の指定方式を「自動（常に現在）/直接指定」で切替可能にし、既定は自動（抽出実行時点の現在）。
- 削除済みテンプレートが再起動で復活する不具合を抑止（移行済みマーカー導入）。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.4.4 に統一。
- `docs/RELEASE_NOTES_v2.4.4.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---


## v2.4.3 (2026-01-04) - メール通知タブ: 運用モード/本番宛先の運用改善（表示簡略化・設備管理者宛先追加）

### ✉️ メール通知タブ（運用改善）

- 運用モード表示を「テスト/本番」に簡略化し、画面上の判別を明確化。
- 本番送信先に「設備管理者」を追加し、投入者/所有者に加えて宛先へ含められるよう改善。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.4.3 に統一。
- `docs/RELEASE_NOTES_v2.4.3.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---


## v2.4.2 (2026-01-03) - データ取得2: メール通知タブ拡張（運用モード/宛先選択/送信ログ閲覧/テンプレ/設備管理者）+ 設備管理者ダイアログ改善

### ✉️ データ取得2: メール通知タブ（運用支援の拡張）

- 宛先選択（テスト/本番、投入者/所有者/両方）を明確化し、誤送信防止の導線を強化。
- テンプレート編集をダイアログ化し、本文/件名とプレースホルダ運用を分離。
- 送信ログの閲覧/保存を継続し、運用監査と二重送信防止を支援。

### 🏭 設備: 設備管理者（Equipment Managers）

- 設備IDごとに管理者（name/mail/note）を編集・永続化（`input/equipment_managers.json`）。
- メール通知テンプレートで設備管理者情報をプレースホルダとして利用可能に。
- 装置名表示のフォールバック補完を強化し、表示不具合（ソート中の行追加でセルがズレる問題）を修正。

### 🌐 ネットワーク

- requests-wrapper の User-Agent 表記をアプリの `REVISION` と同期。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.4.2 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.4.2.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---


## v2.4.1 (2026-01-02) - データ取得2: メール通知タブ改善（運用モード/宛先選択/抽出範囲プリセット/送信ログ閲覧/From表示名）

### ✉️ データ取得2: メール通知タブ

- 抽出条件の「範囲（日）」を初期値7日・最大999日に変更し、プリセット（1/3/7/30/180/365日）で素早く切替可能に。
- 運用モードを「テスト/本番」のラジオ選択に変更し、誤送信防止と運用意図を明確化。
- 本番送信先を「投入者/所有者/両方」から選択可能にし、通知先の運用要件に対応。
- 送信ログの閲覧機能を追加し、二重送信防止（送信先+件名キー）と監査を支援。

### ⚙️ メール設定: From表示名

- Gmail/SMTP の From表示名（任意）を設定可能にし、メールヘッダへ反映。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.4.1 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.4.1.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---

## v2.4.0 (2026-01-01) - データ登録: 登録状況タブ拡張（自動確認/ポーリング/表示高速化/列追加）

### ✅ データ登録: 登録状況タブ拡張

- 自動確認（10秒ポーリング）を追加し、進捗の可視化と手動停止トグルに対応。
- リンク列縮小・水平スクロール対応で、見切れ/操作性を改善。
- 投入者/所有者(所属)/エラーコード/エラーメッセージ列を追加。

### 🗂 キャッシュ/高速化

- entry detail の個別JSON保存を追加。
- 全件キャッシュが存在する場合の高速表示と、最新取得結果による部分更新に対応。

### 🧩 UI/UX

- 登録状況タブ表示時に発生していたウィンドウ固定幅化を解消し、リサイズ可能に修正。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.4.0 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.4.0.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---

## v2.3.16 (2025-12-31) - データエントリー編集（送り状）: 所属/試料モード/レイアウト改善 + スクロール/初期サイズ最適化

### 🧾 データエントリー編集（送り状 / invoice）

- データエントリー一覧から、送り状（invoice）の編集ダイアログを開いて更新できるように改善。
- 更新成功後に再取得して一覧へ反映。

### 👤 基本情報: データ所有者（所属）編集

- 通常登録と同様に、データ所有者（所属）を選択して更新できるように改善。

### 🧪 試料情報: 3択モード維持

- 試料情報は直接編集ではなく、「前回と同じ / 既存試料IDを指定 / 新規作成」の3択モードを維持して更新。

### 🧩 編集ダイアログ UI 改善

- 編集ダイアログをスクロール対応にし、初期サイズを画面比率（幅50%/高さ80%）へ最適化。
- 基本情報/試料情報を2列レイアウト（ラベル列 + 入力列）に統一し、縦長を抑制。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.16 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.16.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---

## v2.3.15 (2025-12-31) - AI説明文提案: データセットタブ追加 + ログビューア改善 + テスト安定化

### 🤖 AI説明文提案（データセット）

- AI説明文提案ダイアログに「データセット」タブを追加。
- 従来のコンボ選択方式を廃止し、「一覧テーブル選択 + 列別フィルタ」方式へ移行。
- 一括問い合わせ/並列問い合わせ（キャンセル含む）に対応。

### 🧾 ログビューア（結果一覧）

- 結果一覧から開くログ表示で、JSONログを「ツリー表示 / JSON全文表示」で切替可能に改善。
- 「標準テキストエディタで開く」ボタンを追加。

### 🧪 テスト/安定性（テーマ切替）

- pytest 実行時のテーマ切替で、重いグローバルQSS適用やトップレベル更新の影響を抑制。
- 長時間スイートでのタイムアウト発生を低減。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.15 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.15.md` を追加。
- 旧最新版のリリースノートを `docs/archive/release_notes/` に退避。

---

## v2.3.14 (2025-12-30) - UI黒化対策（ScrollArea viewport 背景）+ RDE欠落ID除外 + テスト安定化/規約準拠

### 🎨 UI/テーマ

- ウィジェット切替などで低頻度に発生する「意図しない黒い領域」を抑止するため、`QScrollArea` の viewport 背景へテーマ色を直接適用する仕組みを追加。
  - 透明/未描画領域が黒にフォールバックする経路を低減。

### 🧩 データ整合性（RDE側削除データの除外）

- RDE API で 404/410 が確定したデータセット/サブグループIDをローカルに記録し、以後コンボ候補から除外。
  - ローカルJSONとRDEの乖離により編集途中でサーバ側エラーになるケースを、UI側で早期に抑止。

### 🧪 テスト/品質

- pytest 実行時にモーダルダイアログやネットワークアクセスで固まらないようガードを整備。
- `src/` 配下での `unittest.mock` 依存（規約違反）を解消。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.14 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.14.md` を追加。

---

## v2.3.13 (2025-12-29) - データ構造化XLSX: V6/V7混在のテンプレ列を行ごとに最新版選択 + テスト追加

### ⚙️ 設定: データ構造化（XLSX）

- 対応ファイル形式(XLSX)の解析で、テンプレートID/名の取得を改善。
  - 従来: 「最新列固定」（例: V7列のみ参照）
  - 今回: 行単位で「値が入っている最大Vn」の列を採用（V6/V7混在に対応）

### 🧪 テスト/品質

- V6/V7混在ケースのユニットテストを追加し、回帰を防止。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.13 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.13.md` を追加。

---

## v2.3.12 (2025-12-29) - AI説明文提案: 結果一覧クリックでログ表示 + 重要技術領域(nan)表示の空値化 + テスト追加

### 🤖 AI説明文提案（結果一覧）

- 結果一覧テーブルの行クリックで、対応するログ内容（JSON/テキスト）を表示できるよう改善。
- 対象=報告書の「重要技術領域（主/副）」が欠損（nan）のときは空値表示になるよう正規化。

### 🧪 テスト/品質

- ログ表示（JSON/テキスト）および nan→空値 の挙動をウィジェットテストで固定。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.12 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.12.md` を追加。

---

## v2.3.11 (2025-12-29) - Geminiモデル管理改善（認証方式別）+ APIキー無しモデル取得フォールバック + テスト安定化

### 🤖 AI（Gemini）

- 認証方式（API Key / Vertex サービスアカウントJSON）ごとに、モデル一覧とデフォルトモデルを別々に保存・復元できるよう改善。
- APIキー未設定でも、公式モデルページ解析によりモデル候補を取得できるフォールバックを追加（取得結果は環境により変わる場合があります）。

### 🧪 テスト/品質

- headless 実行で不安定になりやすい統合テストを見直し、安定性を改善。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.11 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.11.md` を追加。

---

## v2.3.10 (2025-12-28) - AI説明文提案（報告書）: 結果一覧に重要技術領域（主/副）列を追加 + テスト決定性改善

### 🤖 AI説明文提案（報告書）

- 「結果一覧」タブで対象=報告書の場合、`target_key` のARIM課題番号と報告書リストを結合し、
  「重要技術領域（主）」および「重要技術領域（副）」の列を追加表示。

### 🧪 テスト

- 報告書タブ/結果一覧タブのウィジェットテストがローカルの実データやキャッシュに影響されないよう決定性を改善。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.10 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.10.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.9 (2025-12-28) - テスト安定化（Windows/Qt・長時間スイート）+ テーマ追従の破棄後コールバック抑制 + ドキュメント更新

### 🧪 テスト安定化（Windows/Qt・長時間スイート）

- 長時間のpytest実行で発生しうる「破棄済みQtオブジェクト参照」起因の不安定化を抑制（destroyed時のdisconnect/弱参照化/生存チェック）。
- Windowsのウィジェットテストがネイティブウィンドウ資源に影響されにくいよう調整し、フルスイート完走性を改善。

### 🎨 UI/テーマ

- テーマ変更シグナルの接続管理を整理し、破棄後コールバックによるエラー/不安定化を抑制（通常実行の挙動は維持）。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.9 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.9.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.8 (2025-12-27) - テスト安定化（Windows/Qt）+ テーマ切替/モジュール汚染の不具合修正 + ドキュメント更新

### 🧪 テスト安定化（Windows/Qt）

- Windows/pytest環境で稀に発生する 0x8001010d 系のノイズ/クラッシュ要因を抑制し、フルスイートの安定実行を改善。
- `sys.modules` 直書きによるモジュール汚染を解消し、後続テストでの ImportError を防止。
- パフォーマンス計測ログの終了時ダンプをテスト実行では抑制し、不要なログエラー出力を防止。

### 🎨 UI/テーマ

- pytest実行時のテーマ切替でイベント処理が原因の不安定化が起きないように調整（通常実行の挙動は維持）。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.8 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.8.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.7 (2025-12-24) - AI安定化（Gemini MAX_TOKENS復旧）+ 設定画面のSSL警告抑制 + 規約準拠改善

### 🤖 AI安定化 / デバッグ性向上

- Gemini: `finishReason=MAX_TOKENS` で本文が欠落/空となるケースに対し、`maxOutputTokens` を自動増量して再試行し失敗を抑制。
- AI: provider/model 等を含むパラメータを `request_params` / `response_params` として可視化し、デバッグ性を向上。

### 🌐 ネットワーク

- 設定タブの外部疎通系で `verify=False` を強制しないよう統一し、truststore/CAバンドル設定に追従。

### 🎨 UI/テーマ/パス

- 一部ハードコード色と `__file__` 依存を解消し、規約準拠とテーマ追従を改善。

### 🧪 テスト・品質管理

- 全テストスイートを実行し合格（環境依存の skip は継続）。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.7 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.7.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.6 (2025-12-24) - データ登録UX改善（通常/一括の完了挙動分離）+ テスト強化

### ✅ データ登録 UX 改善

- 通常登録: 必須未入力でも押せる導線を維持しつつ、未入力の可視化（項目名列挙）と押下時アラートで入力を促すように改善。
- 通常登録: 完了時は「確認」押下まで閉じない（他操作をブロックし、結果を確実に読める）挙動へ整理。
- 一括登録: 確認回数を減らすため、完了時は確認を要求せず自動クローズ寄りの挙動へ整理。

### 🧪 テスト・品質管理

- 通常登録/一括登録それぞれの完了ダイアログ挙動をウィジェットテストで検証。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.6 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.6.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.4 (2025-12-23) - データポータル修正（装置・プロセス関連カタログ生成）+ テスト安定化

### 🧩 データポータル修正（装置・プロセス）

- 装置・プロセスの右側に固定幅の機能列を追加。
- 「関連カタログ」ボタンで、dataset detail JSON の `relatedDatasets` から関連候補を抽出し、公開JSONからリンクHTMLを生成。
- 確認ダイアログで見出しテキストと見出しタグ（既定 `h2`）を編集可能。

### 🧪 テスト・品質管理

- xfail/xpass を整理し、汚染時は `skip`、通常時は `pass` となるように調整。
- ダイアログ/スレッド起動をスタブ化したウィジェットテストを追加し、フレークを抑制。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.4 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.4.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.3 (2025-12-22) - データセット修正UI改善（関連データ）+ テスト更新/安定化

### 📊 データセット修正（関連データ）

- 関連データセット設定（ビルダーダイアログ）の操作性/安定性を改善。
- 選択件数が1件（index=0）の場合に未選択扱いになる不具合を修正。

### 🧪 テスト・品質管理

- 既存実装に合わせてウィジェットテストを更新。
- 外部依存（ネットワーク/モーダル UI）に起因するフレークを抑制し、スイート完走性を改善。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.3 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.3.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.2 (2025-12-21) - テキストエリア可視性改善（枠線/背景）+ テスト強化

### ✍️ テキストエリア可視性（枠線/背景）

- QTextEdit/QTextBrowser/QPlainTextEdit の枠線・背景が環境差で見えにくい問題を改善（viewport直適用のフォールバック追加）。
- ライトテーマでテキストエリア背景が周囲パネル背景と同化する問題を修正。

### 🧪 テスト・品質管理

- 描画結果（枠線/背景）を `grab()` のピクセル検証で確認するウィジェットテストを追加。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.2 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.2.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.1 (2025-12-20) - データセット機能改善（API再取得 + キーボード操作対応）

### 📊 データセット機能改善

- データセット更新後、RDE APIから最新データを再取得して表示するように改善。
- データセット編集コンボボックスでカーソルキー・PageUp/PageDown・マウスホイール操作に対応。
- コンボボックス本体のアイテム格納を修正し、件数プレースホルダー表示と操作性の不整合を解消。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.1 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.1.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.3.0 (2025-12-20) - ログイン安定化（トークン出現待ち）+ テスト環境オフライン化 + バージョン表記更新

### 🔐 自動ログイン安定化（トークン出現待ち）

- 固定sleep依存を廃止し、WebViewのstorageにトークンが出現することを条件に待機（バックオフ+総タイムアウト）して自動ログインを安定化。
- **自動ログイン時のみ**、RefreshTokenがある場合のフォールバック挙動を最適化。

### 🧪 テスト環境オフライン安定化

- pytest実行時の外部HTTP依存を制限し、オフライン環境でもテストスイートが完走できるように調整。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.3.0 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.3.0.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.2.8 (2025-12-18) - データセット開設フィルタUI改善 + 基本情報キャッシュ判定修正

---

## v2.2.9 (2025-12-19) - ログイン安定化（トークン出現待ち）+ テスト環境オフライン安定化

### 🔐 自動ログイン安定化（トークン出現待ち）

- 固定sleep依存を廃止し、WebViewのstorageにトークンが出現することを条件に待機（バックオフ+総タイムアウト）して自動ログインを安定化。
- Material側トークンの取得遅延（MSAL等の非同期書き込み）に起因する起動直後の自動ログイン失敗を低減。
- **自動ログイン時のみ**、RefreshTokenが存在する場合にフォールバックでアクセストークン再取得を試行。

### 🧪 テスト環境オフライン安定化

- pytest実行時の外部HTTP依存を抑制し、オフライン環境でもテストスイートが完走できるように調整。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.2.9 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.2.9.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

### 🧩 データセット開設フォーム（新規開設/新規開設2）UI

- ロール/サブグループ/テンプレート/組織フィルタのラベル文言を整理。
- ロールフィルタに「フィルタなし」を追加し、絞り込み解除を明示。

### 📊 基本情報: キャッシュ判定の安定化

- サブグループ0件ケースで subGroups/ を欠損扱いにせず、不要な再取得を抑制。

### 📚 ドキュメント

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.2.8 に統一。
- `docs/archive/release_notes/RELEASE_NOTES_v2.2.8.md` を追加。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.2.7 (2025-12-17) - Windows / pytest-qt テスト安定化 + バージョン表記更新

### 🧪 Windows / pytest-qt テスト安定化

- pytest実行時のみ、ネイティブUI操作（ダイアログ/可視化/強制processEvents等）を抑制し、0x8001010d 系の致命的クラッシュを回避。
- テスト時のウィジェット生成・showイベント周辺の副作用を低減し、テストスイートの完走性を改善。

### 📚 バージョン表記更新・ドキュメント整理

- VERSION.txt / README / CHANGELOG / リリースノート等の表記を v2.2.7 に統一。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q`

---

## v2.2.6 (2025-12-13) - データポータルアップロードUI改善 + TAGビルダーAI提案

### 🗂 データポータル: データセットアップロードUI改善

- 取得済み画像一覧を4列テーブル化（選択/ファイル名/キャプション/アップロード）し、キャプション編集・ヘッダ固定・ソート・アップ済み「Up済」表示に対応。
- アップロード時にキャプションを反映（空の場合はファイル名を使用）し、確認と再実行の手戻りを削減。

### 🏷 データセット編集: TAGビルダーAI提案タブ

- 指定プロンプトでAIへ問い合わせし、候補タグ（label）を一覧表示して採用できるように改善。
- 「リトライ提案」「プロンプト全文」「回答全文」「全て採用」を追加。
- 重複タグは自動的に除外。

### 📚 ドキュメント

- VERSION.txt / README / リリースノート等のバージョン表記を 2.2.6 に統一。

### 🧪 テスト（推奨）

- `./.venv/Scripts/python.exe -m pytest -q -k 'test_revision_sync'`
- `./.venv/Scripts/python.exe -m pytest -q -k 'tag_builder_ai'`

---

## v2.2.5 (2025-12-10) - AIサジェスト管理の安定化 + ドキュメント更新

### 🧠 AIサジェスト管理ダイアログ

- `AIExtensionConfigDialog` のレイアウトクリア処理を刷新し、`takeAt()` でスペーサやストレッチを必ず破棄してからウィジェットを再構築することで、設定ダイアログ終了直後に発生していた「AI拡張設定の読み込みエラー」を解消。
- 再描画後に `SpinnerButton` リストと内部キャッシュを同期し、AI説明文提案タブへ戻った際もボタン数・状態が常に一致するように改善。

### 🧪 信頼性検証

- `tests/widgets/test_ai_extension_spinner.py` に `test_extension_buttons_reload_without_error` を追加し、設定保存→再読込フローで例外が発生しないこととボタン構成が完全に再生成されることを自動検証。
- 既存のスピナービュー系テストと組み合わせ、AI拡張タブのロードシーケンス全体を網羅するリグレッション対策を整備。

### 📚 ドキュメント整備

- README / readme.txt / LICENSE-dist / ヘルプ群 / セットアップスクリプトを含む各種ドキュメントのバージョンを 2.2.5 へ統一し、ユーザー向け表記ゆれを解消。
- v2.2.4 リリースノートを `docs/archive/` 配下へ退避し、新しい `docs/archive/release_notes/RELEASE_NOTES_v2.2.5.md` を追加して履歴管理を継続。

### 🧪 テスト

- `./.venv/Scripts/python.exe -m pytest -q tests/widgets/test_ai_extension_spinner.py -k reload`
- `./.venv/Scripts/python.exe -m pytest -q tests/unit/test_revision_sync.py`

---

## v2.2.4 (2025-12-10) - 設備/報告書リスティング + キャッシュ/検索強化

### 🧾 フィルタ可能なリスティングタブ

- Equipment / Reports タブ向けに `ListingTabBase` と `ListingFilterProxyModel` を実装し、列フィルタ・ソート・件数表示・再読込を共通UIとして提供。
- 最新JSONを読み込んで長文列のトリミングやツールチップ表示を行い、ステータスラベルに読み込み元ファイルとJST時刻を表示して検証作業を簡素化。

### 💾 ReportCacheManager とキャッシュモード切替

- 新しい `ReportCacheManager` / `ReportCacheMode` が取得済みレポートの再利用（SKIP）と強制上書き（OVERWRITE）を切り替え可能にし、ワーカー・ログ・バッチ処理を統合。
- キャッシュ命中数をUIとログで可視化し、長時間ジョブの途中再実行を高速化。キャッシュディレクトリは `output/arim-site/reports/cache/` に配置。

### 🔍 Basic Info 検索設定ダイアログ

- `BasicInfoSearchDialog` を新設し、「自分のデータセット」「キーワード直接指定」「機関ID+年度レンジ」の3モードで検索キューを構築可能に。
- 助成番号プレフィックスと年度レンジからキーワードを自動生成し、プレビューで確認してからバッチ登録できるため、連続検索ジョブを安全に実行。

### 🛰 設備一覧スクレイパーと欠損検知

- `FacilityListingScraper` が `facility.php?mode=search` を巡回して設備IDを収集し、全件取得や連続不在検知を自動化。
- 設備タブから全件取得モードを実行し、最新キャッシュJSONに欠損がある場合もワンクリックで再取得できるように改善。

### 🧪 テスト

- `pytest -q -k "listing_support or equipment_tabs_refresh or report_tabs_refresh"`
- `pytest -q -k "report_cache_manager or report_cache_mode"`
- `pytest -q -k "basic_info_search_dialog"`

---

## v2.2.3 (2025-12-09) - まとめXLSX選択出力 & Explorer連携

### 📂 プロジェクトJSONの選択制御

- まとめXLSX出力前に `groupOrganizations` / `groupProjects` / 外部JSON を個別に選べるダイアログを実装し、既定レイアウトから分割テンプレートまで柔軟に生成可能に。
- 欠損しているJSONはその場で警告し、Basic Info タブでの再取得導線を表示して空のまま出力される事故を防止。

### 📁 出力結果一覧ビュー

- 1回の実行で複数ファイルを生成した場合に出力結果をテーブルで一覧表示し、ファイル名・サイズ・更新時刻・ステータスを可視化。
- 行をダブルクリックまたはボタンクリックで対象ファイルをすぐに開けるほか、失敗行のみ再出力する操作も提供。

### 🗂 Explorerショートカット & フォーカス制御

- まとめ完了後に `output/basic_info/summary/` をエクスプローラーで即座に開くショートカットと、自動フォーカスのオン/オフを追加。
- フォルダが存在しない場合でも再生成してから開くため、事前にパスを整える必要がない。

### 🧪 テスト

- `./.venv/Scripts/python.exe -m pytest -q -k "summary_xlsx or explorer_shortcut_dialog"` — JSON選択ロジックと出力一覧ダイアログのユニット/ウィジェットテストが合格。
- `./.venv/Scripts/python.exe -m pytest -q tests/widgets/test_basic_info_summary_explorer.py` — Explorerショートカットのウィジェットテスト 4 passed。

---

## v2.2.2 (2025-12-08) - データエントリー統計共有 & STRUCTURED JSON強化

### 📊 データエントリー統計の共通化

- `classes/dataset/util/data_entry_summary.py` を追加し、dataEntry API レスポンスを解析してファイルタイプ別件数/サイズと shared1/2/3 の統計を共通ヘルパーで管理。
- データセットタブの統計ラベルと PortalEditDialog の自動入力ボタンが同じ値を参照することで画面間の整合性を確保。

### 🪄 データポータルのファイル統計自動入力

- PortalEditDialog に「共用合計２から適用」ボタンを実装し、shared2統計からファイル数・総サイズをそのままフォームへ反映。
- dataEntry JSON が不足している場合は API 再取得を促すダイアログを表示し、値のプレビュー後に Yes/No で適用可否を判断可能。

### 🧠 STRUCTUREDファイルのJSONコンテキスト

- DatasetContextCollector が STRUCTUREDファイルを JSON 文字列へ整形し、`{json_from_structured_files}` プレースホルダを AI/AutoSetting から利用できるように更新。
- CSV/Excel などの表構造を維持したままプロンプトへ渡せるため、説明文生成やデータポータルテンプレートの精度を向上。

### 🧪 テスト

- `pytest -q -k "data_entry_summary or dataset_context_structured_json or portal_file_stats_button"` を開発リポジトリで実行し、追加ユニット/ウィジェットテストが全て合格。

---

## v2.2.1 (2025-12-08) - テンプレート/装置チャンク整合性

### 📦 基本情報タブのチャンク永続化

- テンプレート/装置チャンク用の保存先を起動時に自動生成し、欠損や権限エラーを防止
- 取得が完了したチャンクをクリーンアップし、再実行時の整合性を担保

### 🔁 APIページネーションの堅牢化

- ページネーションヘルパーでチャンクファイルの書き出しと再利用に対応し、ネットワーク再試行時の復旧を容易化

### 🗂️ バイナリ版のユーザーディレクトリ配置

- バイナリ実行時は `config/`, `input/`, `output/` を `%LOCALAPPDATA%/ARIM-RDE-TOOL/` 配下に作成し、Program Files など書き込み制限のある場所でも動作
- 既存データは新しいユーザーディレクトリへコピーすることで移行可能

### 🧪 テスト

- チャンク処理ユニットテストを開発リポジトリで追加し、全件合格を確認

---

## v2.2.0 (2025-12-06) - 包括的改善リリース

### 🚀 基本情報タブの並列化・完全性強化

- サブグループ完全性チェックを強化し、欠損検知時の再取得ループを最適化
- 進捗表示を全面的に改善し、取得・再取得の各ステップを細分化して可視化
- 並列化を最適化し、大規模プロジェクトでも安定して処理できるように調整

### 🤖 AI機能安定化

- `llm_model_name` プレースホルダの置換を完全対応し、設定変更時の取りこぼしを解消
- AI CHECK 系の処理を安定化し、タイムアウト・リトライ・エラー表示を調整

### 📑 データセット管理の改善

- 関連データ・関連情報ビルダーダイアログを改善し、入力補助とバリデーションを強化
- データセット・データエントリーの日時表示を日本時間（JST）に統一
- Completer フィルタ選択や2段階検索の最適化を継承し、操作性を向上

### ⚙️ 設定・ネットワーク・CLI の強化

- 設定タブの整理と保存方式の暗号化強化を継承し、環境依存性を低減
- CLI オプションの整理（ログレベル指定など）とヘルプ表示の改善
- truststore 完全対応を維持し、企業プロキシ・証明書環境での安定性を確保

### 🧪 テスト

- 開発リポジトリにて458件のユニットテストを実行し全合格（widget含む）

---

## v2.1.24 (2025-12-06) - サブグループ完全性チェック・UI安定化

### 🔄 サブグループ完全性チェックと自動再取得

- `groupOrgnizations` と `subGroups` の差分を検出し、欠損があれば再取得ループを必ず実行
- 欠損IDをログに出力し、再取得対象を明示

### 📊 取得ループの詳細ログ強化

- 成功/失敗/スキップ件数を逐次記録し、force_download有無と処理時間をログ化
- API呼び出し直前にファイル有無を判定し、スキップ/再取得を決定

### 🛠️ グループ選択ダイアログのUIスレッド固定

- 選択ダイアログをUIスレッド同期実行に統一し、基本情報取得時のクラッシュを解消
- `--force-dialog` やプロジェクト単一ケースでも安全にダイアログを表示

### 🧰 その他

- データセットフィルタの既定プログラムを `all` に統一して初期表示を安定化
- 認証情報保存を `encrypted_data` キーでラップし、既存フォーマットも後方互換で読み込み

### 🧪 テスト

- `./.venv/Scripts/python.exe -m pytest -q tests/unit/test_show_group_selection_if_needed.py` — 6 passed
- `./.venv/Scripts/python.exe -m pytest -q -k 'data_fetch2_dataset_combo_behavior or file_filter_widget_layout'` — 2 passed, 2 skipped, 678 deselected

---

## v2.1.16 (2025-12-04) - 説明文品質チェック機能・フォント可読性向上

### 🔍 データセット修正タブ: 説明文品質チェック機能

- **「AI CHECK」ボタン追加**
  - 説明文の妥当性を簡易評価（合格/微修正推奨/要修正/判定不能）
  - AIRequestThread での非同期実行（タイムアウト30秒・リトライ最大2回）
  - JSON検証・修正・QMessageBox での結果表示
  - エラーハンドリング: 未選択/未入力/解析エラー/実行エラー完全対応

### 🎨 AI CHECK 結果表示ダイアログ: フォントサイズ改善

- スコア表示: 18px → 24px
- 文字数表示: 14px → 20px
- 判定結果ラベル: 14px → 18px
- テキストセクション: 10px → 11px (line-height: 1.5)
- ボタンフォント: 12px（高さ 36px に統一）
- 判定コメント表示領域: 100px → 120px
- 詳細ダイアログラベル: 12px 太字, テキスト 11px

---

## v2.1.15 (2025-12-03) - 配布版更新・リリース整備

### 📦 配布・リリース

- バージョンリビジョン更新（2.1.15）
- 公開配布ドキュメント整備（`VERSION.txt`, `README.md`, `docs/archive/release_notes/RELEASE_NOTES_v2.1.15.md`）
- Gitタグ `v2.1.15` 作成・GitHubリリース公開
- バイナリ添付: `dist/arim_rde_tool_setup.2.1.15.exe`

### ℹ️ 備考

- 本公開配布リポジトリはバイナリ配布専用のため、ソースコードの変更は含みません
- 開発リポジトリ（`C:/vscode/rde`）の変更に追随した配布手順・ドキュメントの更新のみを行っています

## v2.1.14 (2025-12-02) - 自動設定ダイアログ改善・設備リンク名称表示

### 🎨 データポータル自動設定ダイアログ改善

- **情報源選択ダイアログに説明文表示を追加**
  - 全ての自動設定ダイアログ（重要技術領域・横断技術領域・装置・プロセス）に説明文を表示
  - ダイアログの機能と情報源（報告書/AI）を明示してユーザビリティ向上
  - `AutoSettingDialog` に `description` パラメータを追加
  - 自動説明生成機能 `_generate_description()` 実装

### 🔧 装置・プロセス自動設定の2段階フロー実装

- **第1段階**: `AutoSettingDialog` で情報源選択と候補取得
- **第2段階**: `SelectiveReplacementDialog` で選択的置換
- 重要技術領域・横断技術領域と統一されたUX提供
- 候補取得時のプログレスダイアログを `AutoSettingDialog` 内に集約

### 🏢 設備リンク名称付与機能

- 設備ID + 設備名の形式に改善（例: "NM-005:液中原子間力顕微鏡 (AFM)"）
- `facility_link_helper` に設備名取得・名称付きアンカー生成機能追加
- 従来の設備IDのみのリンクから視認性向上

### 🧪 テスト

- AutoSettingDialog用テスト5件追加（widget汚染対策実装）
- 全テストスイート正常動作確認

---

## v2.1.13 (2025-12-02) - ブラウザ起動ボタン・設備リンク自動化

### 🔗 データセット/公開ページ連携

- 「🌐 ブラウザで表示」ボタン追加
  - 検索結果HTMLから `code`/`key` を抽出し、環境別公開ページURLを生成
  - 既定ブラウザで公開ページを起動

### 🧩 装置・プロセス 自動設定

- 設備ID→code 解決の自動化（最新 `output/arim-site/facilities_*.json` を参照）
- `<a href="https://nanonet.go.jp/facility.php?mode=detail&code={code}">{ID}</a>` 形式のリンクタグ生成

### 🛠 ユーティリティ追加・安定化

- `classes/utils/data_portal_public.py`: 公開ページURLビルダー
- `classes/utils/facility_link_helper.py`: 設備リンク生成ヘルパー
- パス管理の誤インポート修正（`config.common` に統一）

### 🧪 テスト

- ユニットテスト強化（utils ほか）
- 代表ウィジェットテストは環境差のため `xfail` 指定

---

## v2.1.12 (2025-12-01) - データセット修正タブUI改善

### 🎨 データセット修正タブUI改善

- **関連データセット入力方式の刷新**
  - 読み取り専用テキストボックス+専用ビルダーダイアログ方式へ変更
  - `RelatedDatasetsBuilderDialog` 新規実装
  - QTableWidgetでの選択済みデータセット一覧表示（助成番号/名称/種別表示）
  - **助成番号からの一括追加機能**: 同一助成番号のデータセットをまとめて追加可能
  - 検索可能なコンボボックスで効率的な選択
  - `datasets_changed`シグナルによるリアクティブな更新

- **関連情報入力方式の改善**
  - QTextEditからQLineEditへ変更し、設定ボタン経由で編集
  - `RelatedLinksBuilderDialog` 新規実装
  - タイトル:URL形式のペア管理
  - テーブル形式での編集（追加/削除/編集機能）
  - リアルタイムバリデーション

- **データエントリー一覧テーブル改善**
  - 列順序修正: 「登録開始日時」列と「リンク」列の内容が反対になっていた問題を修正
  - 日本時間変換機能追加: UTC時刻を日本時間（JST: UTC+9時間）に自動変換
  - 表示形式: `YYYY-MM-DD HH:MM:SS`

### 🔧 内部実装改善

- **ペイロード生成ロジック更新**: `create_dataset_update_payload()`のパラメータ変更
- **イベントハンドラー配置最適化**: ボタン定義後に即座にイベント接続する構造に修正
- **MagicMock汚染対策**: 継続的な品質保証パターン適用

### 🧪 テスト強化

- **新規テスト追加**:
  - `RelatedLinksBuilderDialog`テスト: 4件（全合格）
  - データエントリーテーブル列順序テスト更新: 2件（修正後全合格）
- **既存テスト更新**:
  - `test_dataset_entry_registration_row_split.py`: 列番号変更に対応
  - `test_dataset_edit_widget.py`: ウィジェット生成テスト全合格（3件）

---

## v2.1.11 (2025-11-30) - 設定タブ整理・ヘルプ刷新・ウィンドウ位置ポリシー確定

### ⚙️ 設定タブ改善

- **設定タブ構成整理**
  - 「基本設定」タブ: テーマ・ログレベル・ウィンドウ位置設定
  - 「ネットワーク設定」タブ: プロキシ・SSL証明書・接続テスト
  - タブ分離により設定項目の視認性向上

- **ウィンドウ位置ポリシー確定**
  - 3つの動作モード（前回位置復元/センタリング/OS任せ）
  - 設定の永続化対応
  - マルチモニター環境での動作安定性向上

### 📚 ドキュメント刷新

- **ヘルプドキュメント全面改訂**
  - 最新機能の反映（AI拡張・データポータル統合等）
  - 構成の見直しと可読性向上
  - トラブルシューティング情報の充実

### 🛠️ コマンドライン引数

- **--log-level オプション追加**
  - DEBUG/INFO/WARNING/ERROR/CRITICAL から選択可能
  - デバッグ作業の効率化

---

## v2.1.10 (2025-11-28) - データセット編集機能改善

### 🔧 データセット編集

- **Completerフィルタ選択の完全対応**
  - フィルタ検索で絞り込んだデータセットを選択時、正しくフォームに読み込み
  - 2段階検索方式実装（テキスト完全一致 → IDベース検索）
  - `extract_dataset_id_from_text()` ユーティリティ関数追加

- **バッチ登録422エラー対応強化**
  - RDE必須ヘッダー（`Accept: application/vnd.api+json`）を追加
  - フォールバック時も同じヘッダーを送信
  - 詳細エラー情報（URL・ヘッダー・ボディ）をダイアログで表示

### 🧪 テスト強化

- **新規テスト追加**
  - `test_completer_id_extraction.py`（8テスト）- ID抽出ロジック検証
  - `test_dataset_edit_widget.py`（3テスト）- ウィジェット動作検証
  - 全テストスイート正常動作確認（ユニット15件・ウィジェット22件合格）

### 🐛 バグ修正

- Completer選択時のインデックス検索失敗を修正
- ウィジェットテストの互換性修正（`SupportedFileFormatEntry`対応）

---

## v2.1.9 (2025-11-27) - データポータル機能強化

---

## v2.1.9 (2025-11-27) - データポータル機能強化

### 🔗 データポータル連携改善

- **RDE存在確認機能**
  - データポータルからRDEデータセットへの逆引き確認
  - 既存データの重複登録防止
  - ボタンの自動無効化で誤操作防止

### 🎨 UI改善

- **ファイルリスト表示改善**
  - ファイル情報の視認性向上
  - レイアウトの最適化

---

## v2.1.8 (2025-11-22) - AI拡張機能大幅強化

### 🤖 AI関連新機能

- **ファイルテキスト自動抽出機能**
  - データセット内の複数ファイルから自動でテキスト抽出
  - 対応フォーマット: Excel（.xlsx, .xls）、CSV、JSON、テキストファイル等
  - プロンプトテンプレート内の `text_from_structured_files` プレースホルダーで利用可能

- **使用プロンプト表示ボタン**
  - AI処理実行後、実際に送信したプロンプト内容を確認・コピー可能
  - 文字数・行数の統計情報表示
  - デバッグ・検証用途に最適

- **ファイル抽出設定タブ（永続化対応）**
  - 対象ファイル種別（拡張子指定）
  - 除外ファイルパターン（正規表現対応）
  - 処理ファイル数上限（1～100件）
  - ファイルサイズ上限（1～100MB）
  - 出力文字数制限（100～50,000文字/ファイル）
  - Excel処理オプション（全シート処理/行数上限）
  - 設定の保存・読み込み・リセット機能

### 🔧 技術改善

- 依存ライブラリのセキュリティ更新
- openpyxl 警告抑制（Data Validation extension）
- 文字エンコーディング処理の堅牢化

### 📝 ドキュメント更新

- README.md: AI機能セクション拡充
- AI_FEATURE_GUIDE.md: 新機能説明追加

---

## v2.1.7 (2025-11-22) - テーマ切替最適化

### ⚡ パフォーマンス改善

- **テーマ切替最適化**
  - `refresh_theme()` で配色のみ更新
  - ファイルIO・API呼び出し・UI再構築を完全に回避
  - テーマ変更が即座に反映（処理時間大幅短縮）

- **グローバルスタイル統一**
  - QMenu, QToolTip, QHeaderView, QProgressBar スタイル統一
  - OS/アプリケーションテーマ不一致への対応強化
  - パレット強制適用による一貫性確保

### 🔍 品質保証

- テーマウィジェット監査完了
- テーマ適用検証スクリプト実装
- 全テーマパターンの動作確認完了

---

## v2.1.6 (2025-11-17) - プロキシ・SSL改善完了

### 🔒 セッション・SSL管理強化

- **セッション管理の再構築**
  - `create_new_session()` メソッド追加（グローバルセッションから独立可能）
  - truststore 完全対応（全セッション作成時に Windows 証明書ストア自動適用）
  - MANUAL/HTTP モード統一処理実装

- **SSL/CA証明書診断機能**
  - システムプロキシ自動検出
  - SSL証明書チェーン検証
  - カスタムCA証明書対応テスト
  - MitM環境対応（--allow-mitm / --no-mitm フラグ）

### 🔧 診断ツール体系構築

6種類の統合診断スクリプトを提供：

1. **基本プロキシ診断** (`test_basic_proxy.py`)
2. **システムプロキシ検出** (`test_system_proxy_detection.py`)
3. **SSL/CA証明書診断** (`test_ssl_certificate.py`)
4. **設定保存・読み込みフロー** (`test_config_flow.py`)
5. **連続接続安定性** (`test_connection_stability.py`)
6. **統合診断ランナー** (`run_all_diagnostics.py`)

### 📚 ドキュメント化

- `docs/NETWORK_ACCESS_ARCHITECTURE.md` 完全改訂
  - SSL証明書セクション詳細化（優先順位の明確化）
  - 診断ツール使用ガイド新設
  - Fiddler統合ガイド追加
  - トラブルシューティングセクション充実

- `config/network.yaml` デフォルト設定改善
  - 初期モード設定を DIRECT に変更（プロキシエラー防止）
  - Fiddler 使用例明示

---

## v2.1.5 (2025-11-17) - プロジェクト構成整理

### 📁 コードベース整理

- **プロジェクト構成整理完了**
  - `tests/` フォルダへテストコード移動
  - `tools/` フォルダへユーティリティ類移動
  - リリースノートを `docs/archive/` へアーカイブ

- **PyQt5 残滓完全除去**
  - 全ソースコードから PyQt5 関連コード削除完了
  - PySide6 への完全移行確認

- **依存関係更新**
  - `requirements.txt` 最新化
  - 不要な依存関係削除
  - セキュリティアップデート適用

### 📚 ネットワークアーキテクチャドキュメント化

- `docs/NETWORK_ACCESS_ARCHITECTURE.md` 作成
  - REQUESTS ベースアクセス詳細説明
  - WEBVIEW ベースアクセス詳細説明
  - プロキシ・SSL 設定完全マッピング
  - 依存関係・ファイル構成可視化
  - トラブルシューティングガイド

### 🔧 セッション管理フロー

- `net.session_manager`: グローバルセッション管理
- `net.http_helpers`: HTTP リクエストラッパー
- 使用箇所の完全マッピング・ドキュメント化

---

## v2.1.4 (2025-11-13) - バージョン管理統一・品質改善

### 📋 バージョン管理統一

- VERSION.txt・README.md・CHANGELOG.md 全体で表記統一
- 各ドキュメント・ファイルのバージョン表記一貫化
- RELEASE_NOTES_v2.1.4.md 追加

### 🛠 品質改善継続

- **ログ統一化完了**
  - `print()` から `logger` への統一化完了
  - 全ファイル対応・ログレベル統一管理
  - DEBUG/INFO/WARNING/ERROR の明確なレベル分け

- **既存機能の安定性向上**
  - truststore 統合 SSL 検証
  - API ログ機能・Daily rotation 対応
  - プロキシ再起動プロンプト実装

### 📝 ドキュメント更新

- README.md バージョン表記更新
- CHANGELOG.md 更新

---

## v2.1.4 (2025-11-08) - PyQt5→PySide6完全移行

> **破壊的変更**: このアップデートで PySide6 への完全移行が完了しました。

### 🎉 メジャーアップデート

- **フレームワーク刷新**: PyQt5 → PySide6 完全移行
- **ライセンス方針変更**: LGPLv3 へ統一
- **配布戦略変更**: ソースコード非公開化方針へ移行
- **UI 改善**: PySide6 による UI 品質向上

### 🔧 技術改善

- WebView 動作改善（blob:URL 対応）
- JavaScript 連携改善
- UI レンダリング最適化
- ハイDPI ディスプレイ対応強化

### 📝 ライセンス・配布

- LGPLv3 ライセンス採用
- GitHub Releases での配布体制構築
- バイナリ配布版メインへシフト

---

## 前のバージョン

> 詳細な開発履歴は、開発リポジトリ内の以下を参照してください：
> - `src/config/common.py`: 詳細なバージョン履歴コメント（v2.0.0 以降）
> - `docs/archive/`: 過去のリリースノート
> - README.md: 主要な機能・変更点まとめ

---

## 今後の予定

- **対応予定機能**
  - データカタログの作成・編集
  - 送り状編集機能
  - 添付ファイル削除機能
  - CSVによるグループメンバー一括置換
  - 関連試料設定機能

- **継続的改善**
  - パフォーマンス最適化
  - UI/UX さらなる向上
  - エラーハンドリング強化
  - ドキュメント拡充

### 🎉 新機�E
- truststore統合によるSSL検証強化！Eindows証明書ストア対応！E
- APIアクセスログ機�E実裁E��Eaily rotation・自動クリーンアチE�E�E�E
- プロキシ設定変更時�E自動�E起動�Eロンプト実裁E
- SSL/プロキシ/処琁E��間�E匁E��皁E��グ記録

### 🛠 改喁E�E変更
- 旧機�E�E�E2.1.4以前）�E安定性維持�E堁E��性向丁E
- ト�Eクン管琁E��スチE���E�EokenManager�E��EDICEログイン調査チE�Eルの継承

### 📝 ドキュメント更新
- README.md機�E説明更新
- VERSION.txt更新
- RELEASE_NOTES_v2.1.4.md追加

---
## v2.1.4 (2025-11-10) - ト�Eクン管琁E��スチE��・DICEログイン調査チE�Eル追加

### 🎉 新機�E
- **ト�Eクン管琁E��スチE���E�EokenManager�E�実裁E*
  - OAuth2 RefreshToken対忁E
  - 自動トークンリフレチE��ュ�E�ETimer 60秒間隔、E刁E��マ�Eジン�E�E
  - 手動リフレチE��ュAPI
  - JWT有効期限解析�E管琁E
  - マルチ�Eスト対応！EDE/Material API�E�E
- **ト�Eクン状態表示タブ追加**
  - 褁E��ホスト�Eト�Eクン一覧表示
  - 有効期限・残り時間表示
  - 手動リフレチE��ュボタン
  - 自動リフレチE��ュON/OFF刁E��
- **DICEログイン調査チE�Eル実裁E(v2.1.4)**
  - dice_login_flow_inspector.py�E�標準版・fragment mode�E�E
  - dice_login_flow_inspector_query_mode.py�E�クエリモード版�E�E
  - 自動ログイン機�E・ト�Eクン抽出・JWT解极E

---

## v2.1.4 (2025-11-07) - チE�Eタポ�Eタル統合機�E完�E実裁E

### 🎉 新機�E
- **チE�Eタポ�Eタル統合機�E完�E実裁E*
  - JSON書誌情報アチE�Eロード機�E�E�匿名化オプション・環墁E��認証管琁E��E
  - 画像ファイル一括アチE�Eロード機�E�E�重褁E��ェチE��・プログレス表示�E�E
  - チE�Eタポ�Eタル修正機�E�E��Eフィールドタイプ対応�EメタチE�Eタ動的取得�E2段階保存！E
  - スチE�Eタス管琁E���E�E��E閁E非�E開ワンクリチE��刁E��替え！E

### 🔧 改喁E�E変更
- **UI/UX改喁E*
  - チE��ォルト選択最適化（データセチE��検索をデフォルトに�E�E
  - フィルタ統合（庁E��シェア設定と関係メンバ�EフィルタめE行に統合！E
  - ボタン配置最適化（視認性向上！E
- **アーキチE��チャ改喁E*
  - 責務�E離�E�EI・コア・設定�EユーチE��リチE��の明確な刁E���E�E
  - モジュラー設計！Eore/ui/conf/utilチE��レクトリ構造�E�E
- **チE��チE��機�E強匁E*
  - 全APIレスポンスのHTMLファイル保孁E
  - 詳細ログ出力�EスタチE��トレース付きエラーログ

### 🐛 バグ修正
- フィールド名修正�E�実際のHTML構造に合わせた修正�E�E
- ラベル抽出改喁E��ラジオボタン・チェチE��ボックスのラベル抽出ロジチE��改喁E��E
- 初期表示修正�E�データセチE��検索モードがチE��ォルトで表示されるよぁE��修正�E�E

### 📝 ドキュメント更新
- README.md機�E説明更新
- VERSION.txt更新
- RELEASE_NOTES_v2.1.4.md追加

## v2.1.4 (2025-10-31) - ARIM報告書スクレイピング修正・AI拡張タブ検索補完機�E強匁E

### 🛠 主な変更点
- ARIM報告書のスクレイピング処琁E�E修正・安定化
- AI拡張タブ�E検索補完機�Eを強匁E
- チE�Eタ処琁E��ジチE��の改喁E
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-31) - QWidgetサイズエラー修正・AI Test 2ボタン安定化

### 🛠 主な変更点
- QWidgetサイズエラーの修正
- AI Test 2ボタンの安定化
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-31) - ライブラリ更新・安定性向丁E

### 🛠 主な変更点
- 依存ライブラリの更新・互換性の確俁E
- 軽微な修正・安定性向丁E
- ドキュメント�E整琁E�E更新

## v2.1.4 (2025-10-06) - 軽微な修正・安定性向丁E

### 🛠 主な変更点
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-06) - 軽微な修正・安定性向丁E

### 🛠 主な変更点
- 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-03) - チE�EタセチE��説明AIサジェスト機�E追加

### 🚀 主な変更点
- チE�EタセチE��説明欁E��AIサジェスト機�Eを追加し、説明文の自動生成�E補助が可能になりました、E

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E




## v2.1.4 (2025-09-30) - 軽微な修正・安定性向丁E

### 🔧 軽微な修正・安定性向丁E

## v2.1.4 (2025-10-01) - 軽微な修正・安定性向丁E

### 🔧 軽微な修正・安定性向丁E

# v2.1.4 (2025-10-02) - 機�E追加・安定性向丁E

### 🚀 主な変更点
- 新機�E・改喁E��の記載（例：UI改喁E��バグ修正、パフォーマンス向上など�E�E

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E
# 変更履歴�E�EHANGELOG�E�E

## v2.1.4 (2025-09-22) - 軽微な修正・安定性向丁E

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E

## v2.1.4 (2025-09-21) - 一括登録・サブグループ編雁E�EAIチE��ト�E細かなバグ修正

### 🔧 軽微な修正・安定性向丁E
- 細かな修正・安定性向丁E

## v2.1.4 (2025-09-18) - ドキュメント整琁E�E安定性向丁E

### 📝 ドキュメント整琁E�E安定性向丁E
- README/CHANGELOGのバ�Eジョン履歴を整琁E
- 軽微な安定性向上�E細かな修正

## v2.1.4 (2025-09-17) - 安定性向上�Eドキュメント整琁E

### 🛠�E�E細かなバグ修正・最適匁E
- 冁E��処琁E�E安定性向上�E軽微な不�E合修正
- CHANGELOG/READMEのバ�Eジョン履歴整琁E

## v2.1.4 (2025-09-17) - 安定性向上�Eドキュメント整琁E

### 🛠�E�E細かなバグ修正・最適匁E
- 冁E��処琁E�E安定性向上�E軽微な不�E合修正
- CHANGELOG/READMEのバ�Eジョン履歴整琁E

## v2.1.4 (2025-09-16) - AI機�E拡張・UI改喁E

### 🤁EAI機�E拡張・UI改喁E
- AIプロバイダ・モチE��定義の拡允E��ローカルLLM対応強匁E
- AI設定ファイルの説明追加、AIプロンプトカスタマイズ手頁E�E訁E
- AI連携時�Eエラーハンドリング強化�Eタイムアウト設定追加
- READMEのAI設定�Eバイナリ化手頁E�E既知の不�E合を最新匁E

## v2.1.4 (2025-09-01) - 動的ユーザー管琁E���E実裁E�EAPI補完機�E統吁E

### �E 動的ユーザー管琁E���E実裁E
- **動的ユーザー管琁E��スチE��**
  - rde-member.txtを読み取り専用化、動皁E��加ユーザーはoutput/temp/dynamic_users.jsonに保孁E
  - セチE��ョン間永続化・動的追加ユーザーの再起動後保持・subGroup.jsonとの統合表示
  - 透過皁E��合�E既存�E作�E/編雁E��ブで自動的にAPI補完が動作�Eユーザー体験向丁E

- **API補完機�E統吁E*
  - subGroup.json冁E�E不完�EユーザーチE�Eタ�E�EDのみ�E�をNIMS User APIで詳細チE�Eタ自動補宁E
  - 認証惁E��ストア統合�EBearer token連携・WebView認証後�EAPI呼び出し�E安�Eな認証惁E��管琁E
  - フォールバック機�E・API呼び出し失敗時は既存データを保持・エラー耐性を確俁E

- **シスチE��強匁E*
  - チE�EタセチE��フィルタ強化�E3層キャチE��ュシスチE��・プログレス表示・ComboBox最適匁E
  - 匁E��皁E��スト環墁E�E独立したテストスクリプト群・統合テスト機�E・品質保証体制

## v2.1.4 (2025-09-01) - プロキシ設定重要修正・手動設定値保持問題解決

### 🔧 プロキシ設定重要修正
- **手動プロキシ設定問題解決**
  - 手動プロキシ設定が適用後に自動設定で上書きされる問題を解決
  - 設定適用ロジチE��の最適化�E不要な再読み込み処琁E��除
  - 手動設定値の確実な保持・状態表示の刁E��

- **ユーザビリチE��向丁E*
  - 設定適用時�EチE��チE��ログ追加・適用過程�E可視化
  - 設定確認機�E強化�EトラブルシューチE��ング支援
  - プロキシ設定信頼性向上�E手動・自動設定�E明確な刁E��

## v2.1.4 (2025-09-01) - プロキシ設定UI改喁E�E横並び表示対忁E

### 🎨 プロキシ設定UI改喁E
- **チェチE��ボックス横並び表示**
  - PAC自動設定�E企業CA設定�EチェチE��ボックス横並び表示対忁E
  - 設定画面レイアウト最適化�Eスクロールエリア高さ調整
  - 視認性向上�EユーザビリチE��改喁E

- **プロキシ設定フォーム改喁E*
  - カスタムCA Bundle入力欁E��加・SSL設定�E整琁E��吁E
  - 企業環墁E��応強化�EPAC�E��Eロキシ自動設定）サポ�EチE
  - レイアウト最適化�E惁E��寁E��向上�E操作性改喁E

## v2.1.4 (2025-08-31) - ワークスペ�Eス大規模整琁E��亁E�Eコード�Eース品質向丁E

### 🔄 ワークスペ�Eス大規模整琁E��亁E
- **アーキチE��チャ最適匁E*
  - 不要ファイル削除・コード�Eース品質向丁E
  - 重褁E��ード削除・依存関係整琁E�Eモジュール構造改喁E
  - 開発環墁E��定化・保守性向丁E

- **配币E��チE��ージ最適匁E*
  - PyInstaller配币E��チE��ージ最適化�Eビルド�Eロセス改喁E
  - ドキュメント体系強化�E設計書・仕様書・運用手頁E��の整備�E宁E
  - 継続的品質改喁E�E静的解析�EチE��トカバレチE��向上�ECI/CD基盤強匁E

## v2.1.4 (2025-08-24) - リファクタリング継続�Eフォーム機�E刁E��・保守性向丁E

### 🔄 アーキチE��チャ改喁E
- **責務�E離完亁E*
  - UIControllerForms刁E��によるフォーム機�E専門匁E
  - フォーム関連機�Eの独立クラス匁E
  - UI責務�E確化による保守性向丁E

- **コード�Eース整傁E*
  - 重褁E��ード削除616行！E5.4%削減）完亁E
  - 品質改喁E�EアーキチE��チャ強化継綁E
  - 刁E��されたクラス構造による開発・保守効玁E��

### 📋 ドキュメント更新
- **バ�Eジョン管琁E*
  - `VERSION.txt` v2.1.4更新・変更履歴追訁E
  - `README.md` 最新機�Eセクション・リリース履歴更新
  - 開発進捗反映・技術仕様書最新匁E

## v2.1.4 (2025-08-22) - 継続的メンチE��ンス・コード�Eース整傁E

### 🔄 継続的品質向丁E
- **コード�Eース整傁E*
  - 全ファイルのバ�Eジョン表記統一�E�E2.1.4�E�E
  - ドキュメント最新化�E技術仕様書整備継綁E
  - 開発ガイドライン・保守手頁E��続改喁E

- **安定性維持E*
  - 既存機�Eの堁E��性継続保証
  - バグ修正対応体制継続強匁E
  - チE��トカバレチE��品質水準維持E

## v2.1.4 (2025-08-21) - サブグループUI改喁E�Eパス管琁E��スチE��大幁E��匁E

### �E サブグループ機�EUI大幁E��喁E
- **課題�E力テキストエリア匁E*
  - 一行テキスト�EチE��ス ↁE褁E��行表示可能なチE��ストエリアに変更
  - 褁E��課題�E視認性・編雁E��大幁E��丁E
  - 適刁E��表示領域確保（高さ80px�E�E

- **リアルタイムバリチE�Eション機�E**
  - 改行チェチE���E�改行文字混入の即座検�E・警呁E
  - フォーマット検証�E�`課題番号:課題名`形式適合性リアルタイム確誁E
  - 空欁E��証�E�課題番号・課題名空欁E���E
  - ビジュアルフィードバチE���E�色付きボ�Eダー・メチE��ージによる即座状態確誁E

### 🏗�E�EシスチE��基盤大幁E��匁E
- **パス管琁E��スチE��再設訁E*
  - ワーキングチE��レクトリ依存性完�E解涁E
  - プロジェクト構造自動検証・ルート特宁E
  - 匁E��皁E��ストスイート整備：パス解決・バリチE�Eション・バイナリ環墁E��スチE

## v2.1.4 (2025-08-19) - チE�EタセチE��登録・開設UIバグ修正

### 🐛 バグ修正
- **チE�EタセチE��関連UI修正**
  - PyQt5 import scope error解決
  - チE�EタセチE��登録・開設機�Eの安定性向丁E
  - UI表示エラーの修正

## v2.1.4 (2025-08-18) - AI機�Eレスポンス惁E��表示強化�E統合テストツール追加

### 🤁EAI機�E改喁E
- **レスポンス惁E��表示強匁E*
  - ト�Eクン使用量�E処琁E��間�E詳細表示
  - パフォーマンス惁E��の可視化改喁E
  - ユーザビリチE��向丁E

- **統合テストツール追加**
  - AI性能チE��ト�Eベンチ�EークチE�Eル実裁E
  - 褁E��プロバイダー対応テスト環墁E
  - 結果刁E��・可視化機�E

---

## 主な機�E

### チE�Eタ取得�E登録機�E
- **書誌情報取征E*�E�課題番号リストからRDEの書誌情報とサムネイル画像を自動取征E
- **チE�Eタ取征E�E�ファイル一括取得！E*�E�データセチE��に紐づくファイルを一括ダウンローチE
- **チE�EタセチE��新規開設**�E�サブグループや課題番号を指定してチE�EタセチE��を作�E
- **チE�Eタ登録**�E�実験情報・試料情報・添付ファイルを登録

### サブグループ管琁E���E
- **サブグループ新規作�E**�E�メンバ�Eと権限を持E��した一括登録
- **サブグループ修正**�E�既存グループ�E構�E・課題番号・権限変更

### AI活用機�E
- **実験手法生戁E*�E�OpenAI/Gemini/ローカルLLMによる研究支援
- **品質評価**�E�データ品質の自動評価とアドバイス
- **チE�EタセチE��説明文生�E**�E�研究冁E��に基づく説明文自動生戁E

### ユーチE��リチE��機�E
- **設定ファイル管琁E*�E�JSON/Excel形式での設定保存�E読込
- **エラーハンドリング**�E�詳細なログ出力とエラー回復機�E
- **セキュリチE��**�E�DICE認証・セチE��ョン管琁E
