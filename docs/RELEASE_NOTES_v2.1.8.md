# ARIM RDE Tool v2.1.8 - リリースノート

**リリース日**: 2025年11月22日

---

## 概要

v2.1.8 は、**AI拡張機能の大幅強化**を主眼としたマイナーアップデートです。データセット内のファイルからテキストを自動抽出し、AI処理に活用できる機能を実装しました。また、テーマ切替パフォーマンスの最適化やプロキシ・SSL処理の堅牢化も継続中です。

---

## 主な新機能

### 🤖 AI拡張機能の大幅強化

#### 1. **ファイルテキスト自動抽出機能**

データセット内の複数ファイルから自動でテキストを抽出し、AI処理に活用できます。

**対応フォーマット**:
- Excel ファイル（.xlsx, .xls）
- CSV ファイル
- JSON ファイル
- テキストファイル（.txt, .md 等）

**使用方法**:
1. **AI チャット**タブで「AI拡張」タブを開く
2. 処理対象データセットを選択
3. 「ファイル抽出設定」タブで抽出条件を指定
4. プロンプトテンプレート内で `text_from_structured_files` プレースホルダーを利用
5. **AI処理実行**をクリック

**設定項目**（新規追加）:
- **対象ファイル種別**: 拡張子で処理ファイルを限定
- **除外ファイルパターン**: 正規表現で除外ファイルを指定
- **処理ファイル数上限**: 1～100件（デフォルト: 10件）
- **ファイルサイズ上限**: 1～100MB
- **出力文字数制限**: 100～50,000文字/ファイル
- **Excel処理オプション**:
  - 全シート処理 / 最初のシートのみ
  - 最大行数上限（デフォルト: 無制限）

#### 2. **使用プロンプト表示ボタン**

AI処理実行後、実際にAIに送信したプロンプト内容を確認できます。

**機能**:
- **表示**: 送信したプロンプトの全内容をモーダルウィンドウで表示
- **コピー**: プロンプト全体をクリップボードへコピー
- **統計情報**: 文字数・行数の表示
- **用途**: デバッグ・検証・プロンプト改善の参考

#### 3. **ファイル抽出設定の永続化**

ファイル抽出設定をアプリケーション再起動後も維持します。

**保存方法**:
- 設定は `config/app_config.json` に自動保存
- **設定を読み込む**: 最後に保存した設定を復元
- **設定を保存**: 現在の設定を保存
- **デフォルトに戻す**: 初期設定にリセット

---

## パフォーマンス・品質改善

### ⚡ テーマ切替最適化（v2.1.7 継承）

テーマ切り替え時の処理を大幅に最適化しました。

**改善内容**:
- `refresh_theme()` で配色のみ更新
- ファイル I/O・API 呼び出し・UI 再構築を完全に回避
- テーマ変更が即座に反映される

**効果**:
- テーマ切り替え時の応答性大幅向上
- UI フリーズ回避

### 🔒 プロキシ・SSL 処理の堅牢化（v2.1.6 継承）

企業プロキシ環境や SSL 証明書問題への対応を強化しました。

**対応内容**:
- Windows 証明書ストア自動適用（truststore 統合）
- SSL/CA 証明書診断ツール体系（6種類）
- MitM 環境対応
- Fiddler 統合ガイド

詳細は `docs/NETWORK_ACCESS_ARCHITECTURE.md` を参照してください。

---

## 技術改善

### セキュリティ・依存関係

- 依存ライブラリのセキュリティアップデート
- openpyxl 警告抑制（Data Validation extension warning の非表示化）
- 文字エンコーディング処理の堅牢化
- Python 3.13.5 での動作確認

### 既知の制限

- ファイルサイズが大きい場合、抽出処理に時間がかかることがあります
- 正規表現の複雑な条件は処理速度に影響します

---

## ドキュメント更新

- **README.md**: AI機能セクション拡充・バージョン表記更新
- **CHANGELOG.md**: v2.1.5～v2.1.8 の変更履歴追加
- **AI_FEATURE_GUIDE.md**: 新機能説明追加（今後配布予定）

---

## 既知の不具合・制限

### v2.1.8 での既知事項

- Excel ファイルの一部特殊フォーマット（マクロ含有等）は非対応
- CSV ファイルのエンコーディングが自動判定される（Shift-JIS / UTF-8）
- JSON ファイルの階層が深い場合、抽出処理が時間かかる場合があります

### v2.1.6 以降の既知不具合

- ディスプレイサイズ・解像度により、ウィンドウ・文字サイズが意図せず変化する場合あり
  - 開発環境は特定の解像度・DPI でのみ検証
  - 他環境ではUI要素の重なり・極小表示等が起きる可能性
  - 発生時は OS / 解像度 / DPI を添えて報告してください
  
- 一括登録・サブグループ編集・AI チャットでまれに UI が固まることあり
  - 再起動で解消しない場合はご連絡ください

- RDE リンク機能使用時は、事前にブラウザ（Chrome推奨）で RDE へログイン必須
  - Windows/Chrome のみ確認済み

---

## アップグレード方法

### バイナリ配布版から更新する場合

1. 最新版 ZIP を [Releases](https://github.com/MNagasako/misc-rde-tool-public/releases) からダウンロード
2. ZIP を展開し、`arim_rde_tool.exe` を実行
3. `input/`, `output/`, `config/` フォルダはそのまま保持（設定が引き継がれます）
4. 新しいバージョンが起動することを確認

### 設定ファイルの引き継ぎ

- `input/` フォルダ内のユーザー設定ファイルは自動的に引き継がれます
- `config/app_config.json` はマージされます
- ファイル抽出設定も `config/app_config.json` から自動復元されます

**注意**: 
- 初回起動後、新しいバージョンで「データ取得・事前準備」の再実行を推奨する場合があります
- キャッシュに不整合が生じた場合は、`output/` フォルダを削除して再実行してください

---

## サポート・フィードバック

バグ報告・ご質問・ご要望は、以下の情報を添えて作者に直接ご連絡ください：

- **事象の概要**: 何が起きたか
- **期待される動作**: どうなるはずだったか
- **実際の結果**: 何が起きたか
- **再現手順**: 最小限の手順で再現可能な方法
- **環境情報**:
  - OS バージョン（Windows 10 / 11）
  - ディスプレイ解像度・DPI 設定
  - アプリのバージョン（ウィンドウタイトルに表示）
  - ネットワーク環境（プロキシ有無・ファイアウォール等）

---

## ライセンス

本ツールは **LGPLv3** ライセンスで配布されています。

詳細は `LICENSE` ファイルを参照してください。

---

## 関連リンク

- [GitHub リポジトリ](https://github.com/MNagasako/misc-rde-tool-public)
- [最新リリース](https://github.com/MNagasako/misc-rde-tool-public/releases)
- [CHANGELOG（詳細な更新履歴）](./CHANGELOG.md)
- [README（機能説明・使用方法）](../README.md)
- [AI 機能ガイド](./AI_FEATURE_GUIDE.md)
- [ネットワークアクセスアーキテクチャ](./NETWORK_ACCESS_ARCHITECTURE.md)

---

**本リリースノートは公開配布版向けドキュメントです。開発リポジトリの詳細な履歴は `src/config/common.py` 内のコメントを参照してください。**
