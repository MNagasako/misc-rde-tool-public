# ARIM RDE Tool - Release Notes v2.2.3

**リリース日**: 2025年12月9日

---

## 概要

v2.2.3 は Basic Info タブで生成するまとめXLSXワークフローを全面的に拡張し、プロジェクトJSONの選択制御と出力後の確認作業を効率化したリリースです。従来は固定レイアウトでしか出力できませんでしたが、今回から `groupOrganizations` / `groupProjects` / 外部JSON を任意に組み合わせて分割エクスポートできるようになりました。出力後はダイアログから生成済みファイルを直接開けるため、エクスプローラーでファイルを探す手間がありません。

---

## 主要な改善点

### 📂 プロジェクトファイル選択ダイアログ
- まとめXLSX出力前に、既定JSONと外部JSONを切り替えられるダイアログを表示。
- JSONごとの個別出力や `attributes.name` フィルタを組み合わせ、用途別テンプレートを即座に構築可能。
- 不足しているJSONがある場合は再取得を案内し、欠落したまま出力される状況を防止。

### 📁 まとめXLSX出力一覧ダイアログ
- 1回の実行で複数ファイルを生成した場合、出力結果をテーブルで一覧表示。
- ファイル名・サイズ・最終更新時刻・ステータスを表示し、任意のファイルをその場で開ける。
- エラーが発生したファイルのみ個別に再出力でき、成功分を繰り返し流用可能。

### 🗂 Explorerショートカットとフォーカス制御
- まとめXLSX完了後に `output/basic_info/summary/` を自動でフォーカスできるショートカットを追加。
- フォルダが存在しなくても再生成してからExplorerを開くため、出力パスの事前作成が不要。
- 分割エクスポート時でも直近の出力フォルダを記憶し、連続作業をサポート。

### 🧪 ダミーデータとテスト拡充
- groupProjects・subGroupsを含むサンプルJSONを `input/basic_info_samples/` に追加し、検証用データを標準化。
- summary_xlsxロジックとExplorerボタン向けの単体/ウィジェットテストを追加し、選択的出力やショートカットの動作を自動検証。

---

## テスト状況

- まとめXLSXロジック向けユニットテストで、既定/分割/外部ファイルの各パターンを網羅。
- Explorerショートカットおよび出力一覧ダイアログの Qt ウィジェットテストを追加し、エラー通知とフォーカス制御を確認。
- Basic Info / Config 周辺テストと合わせて全スイートを実行し、リグレッションは発生していません。

---

## 既知の問題 / 注意事項

- Explorerショートカットは Windows Explorer を前提としており、別のファイルマネージャーを既定にしている環境では自動フォーカスできません。
- まとめXLSXの分割数が多い場合、出力一覧ダイアログがスクロール表示になります。生成直後は最新行が画面下部に配置されます。

---

## アップグレード手順

1. v2.2.3 のインストーラーまたは `dist/arim_rde_tool.exe` を取得し、`.venv` を有効化します。
2. Basic Info タブで対象課題のJSONを最新化し、`output/basic_info/json/` に必要なファイルがそろっているか確認します。
3. 新しいまとめXLSXダイアログで使用するJSONを選択し、外部ファイルを混在させる場合は参照パスを指定します。
4. 出力後に表示される結果一覧から生成物を開き、Explorerボタンでフォルダ全体の配置を確認してください。
